<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –∫–æ–º–∞–Ω–¥–∞–º</title>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700;900&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#0d0f14; --panel:#151823; --accent:#ffb703; --ok:#66e3ff; --hun:#ffd166; --muted:#aeb4c2;
}
*{box-sizing:border-box}
body{
  margin:0; font-family:'Montserrat',sans-serif; color:#fff;
  background:
    radial-gradient(1200px 600px at 50% -10%, #1d2130 0%, transparent 60%),
    radial-gradient(600px 400px at 10% 90%, #171a25 0%, transparent 60%),
    #0b0d12;
  min-height:100vh; display:flex; align-items:center; justify-content:center; padding:24px;
}
.container{width:100%; max-width:720px; text-align:center}
h1{margin:0 0 8px; font-weight:900; font-size:clamp(24px,5vw,40px)}
.lead{color:var(--muted); margin:0 0 18px}
.panel{
  background:linear-gradient(180deg,#171a24 0%,#12141c 100%);
  border:1px solid rgba(255,255,255,.08);
  border-radius:18px; padding:24px;
  box-shadow:0 10px 40px rgba(0,0,0,.35);
}

/* –°–∫–∞–Ω–µ—Ä */
.scan-wrap{position:relative; width:min(80vw,420px); height:min(80vw,420px); margin:10px auto 10px}
.scan-circle{
  position:absolute; inset:0; border-radius:50%;
  background: radial-gradient(60% 60% at 50% 40%, #22283a 0%, #151a28 55%, #0f1320 100%);
  box-shadow: inset 0 0 50px rgba(0,0,0,.6), 0 0 60px rgba(0,0,0,.35);
  display:flex; align-items:center; justify-content:center; overflow:hidden; cursor:pointer;
  border:1px solid rgba(255,255,255,.05);
}
.scan-circle:hover{outline:2px solid rgba(255,183,3,.25); outline-offset:3px}

/* –ü—É–ª—å—Å –∏ –±–µ–≥—É—â–∞—è –ª–∏–Ω–∏—è */
.pulse::before{
  content:""; position:absolute; inset:12%; border-radius:50%;
  border:2px solid rgba(255,255,255,.08); animation:pulse 2.2s ease-out infinite;
}
.pulse::after{
  content:""; position:absolute; left:0; right:0; height:3px; top:-3px;
  background:linear-gradient(90deg, transparent, rgba(255,255,255,.35), transparent);
  animation:scanline 2.4s linear infinite;
  opacity:.4;
}
@keyframes pulse{0%{transform:scale(.9); opacity:.7} 70%{transform:scale(1.05); opacity:.15} 100%{opacity:0}}
@keyframes scanline{0%{top:-3px} 100%{top:calc(100% + 3px)}}

.hand{ width:90px; height:90px; border-radius:50%;
  background: radial-gradient(circle at 35% 35%, #ffd166, #ff9e00);
  box-shadow:0 0 18px rgba(255,158,0,.45);
  position:relative; transform:translateY(6px);
}
.hand:after{ content:"üëá"; font-size:38px; position:absolute; inset:0; display:grid; place-items:center; filter:drop-shadow(0 2px 2px rgba(0,0,0,.4)); }

/* –°–ø–∏–Ω–Ω–µ—Ä */
.spinner{ position:absolute; width:92%; height:92%; border-radius:50%; inset:4%;
  border:3px dashed rgba(255,255,255,.18); animation:spin 1.5s linear infinite; display:none }
@keyframes spin{to{transform:rotate(360deg)}}

/* –ü—Ä–æ–≥—Ä–µ—Å—Å –∏ —Ñ—Ä–∞–∑—ã */
.progress{width:80%; height:10px; margin:8px auto 0; background:#0f1422; border-radius:8px; overflow:hidden; display:none}
.progress>span{display:block; height:100%; width:0%; background:linear-gradient(90deg,#ffb703,#ffd166); border-radius:8px; transition:width .18s}
.phase{min-height:24px; color:#adb3c4; margin-top:6px; font-size:14px; display:none}

/* –†–µ–∑—É–ª—å—Ç–∞—Ç */
.result{margin:10px 0 14px; font-size:clamp(18px,3.8vw,26px); font-weight:900; display:none}
.result.ghost{color:var(--ok); text-shadow:0 0 12px rgba(102,227,255,.35)}
.result.hunter{color:var(--hun); text-shadow:0 0 12px rgba(255,209,102,.35)}

/* –ö–Ω–æ–ø–∫–∏ */
.actions{display:flex; gap:12px; justify-content:center; flex-wrap:wrap; margin-top:12px}
.btn{
  padding:14px 18px; border:none; border-radius:12px; cursor:pointer; font-weight:800;
  background:#2a2f42; color:#fff; transition:.25s;
}
.btn:disabled{opacity:.6; cursor:not-allowed}
.btn-primary{background:var(--accent); color:#000; box-shadow:0 6px 16px rgba(255,183,3,.25)}
.btn:hover{transform:translateY(-2px)}
.note{color:#8d94a6; font-size:12px; margin-top:6px}
.small{font-size:12px; color:#8d94a6; margin-top:6px}
</style>
</head>
<body>
  <div class="container">
    <h1 id="title">–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –∫–æ–º–∞–Ω–¥–∞–º</h1>
    <p class="lead">–î–æ–º —á—É–≤—Å—Ç–≤—É–µ—Ç –≤–∞—à—É —ç–Ω–µ—Ä–≥–∏—é‚Ä¶ –ü—Ä–∏–ª–æ–∂–∏—Ç–µ —Ä—É–∫—É –∫ –∫—Ä—É–≥—É ‚Äî –æ–Ω —Ä–µ—à–∏—Ç, –∫—Ç–æ –≤—ã: <b>–ü—Ä–∏–∑—Ä–∞–∫</b> –∏–ª–∏ <b>–û—Ö–æ—Ç–Ω–∏–∫</b>.</p>

    <div class="panel">
      <div class="scan-wrap">
        <div id="circle" class="scan-circle pulse" aria-label="–ö–æ—Å–Ω–∏—Ç–µ—Å—å –¥–ª—è –Ω–∞—á–∞–ª–∞ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è">
          <div class="hand" id="hand"></div>
          <div class="spinner" id="spinner"></div>
        </div>
      </div>

      <div class="progress" id="progress"><span id="bar"></span></div>
      <div class="phase" id="phase">–ì–æ—Ç–æ–≤–ª—é—Å—å —Å–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å‚Ä¶</div>

      <div id="result" class="result"></div>

      <div class="actions">
        <button class="btn" id="again" style="display:none">–°–∫–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –µ—â—ë —Ä–∞–∑</button>
        <a id="goBtn" class="btn btn-primary" href="#" style="display:none">–í –ú–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –¥–æ–º</a>
      </div>
      <div class="note">–ö–æ–º–∞–Ω–¥–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ –∏ –ø–æ–¥—Å—Ç–∞–≤–∏—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤ –¥–æ–º–µ.</div>
      <div class="small">–°–æ–≤–µ—Ç: –ø–æ–∫–∞–∑—ã–≤–∞–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤—Å–µ–º, —á—Ç–æ–±—ã –∏–≥—Ä–æ–∫ —É—Å–ø–µ–ª –≤—Å—Ç–∞—Ç—å –∫ —Å–≤–æ–µ–π –∫–æ–º–∞–Ω–¥–µ.</div>
    </div>
  </div>

<script>
const LS_KEY_TEAM='hn_team';          // –ø–æ—Å–ª–µ–¥–Ω—è—è –≤—ã–¥–∞–Ω–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞ (–¥–ª—è host.html)
const LS_KEY_COUNTS='hn_counts_v1';   // —Å—á—ë—Ç—á–∏–∫ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è

// UI
const title  = document.getElementById('title');
const circle = document.getElementById('circle');
const spinner= document.getElementById('spinner');
const hand   = document.getElementById('hand');
const result = document.getElementById('result');
const goBtn  = document.getElementById('goBtn');
const again  = document.getElementById('again');
const progress = document.getElementById('progress');
const bar = document.getElementById('bar');
const phase = document.getElementById('phase');

// helpers
const label = team => team==='ghosts' ? '–ü–†–ò–ó–†–ê–ö–ê–ú' : '–û–•–û–¢–ù–ò–ö–ê–ú';
const classFor = team => team==='ghosts' ? 'ghost' : 'hunter';
const story = team => team==='ghosts'
  ? 'üëª –í–∞—à–∞ —ç–Ω–µ—Ä–≥–∏—è –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∏—Ç –ü–†–ò–ó–†–ê–ö–ê–ú!'
  : 'üèπ –í–∞—Å –≤—ã–±—Ä–∞–ª–∏ –û–•–û–¢–ù–ò–ö–ò!';

function getCounts(){
  try{
    const raw = localStorage.getItem(LS_KEY_COUNTS);
    if(!raw) return {ghosts:0,hunters:0};
    const obj = JSON.parse(raw);
    return {ghosts: obj.ghosts|0, hunters: obj.hunters|0};
  }catch{ return {ghosts:0,hunters:0}; }
}
function setCounts(c){ localStorage.setItem(LS_KEY_COUNTS, JSON.stringify(c)); }

// –ë–∞–ª–∞–Ω—Å–∏—Ä—É—é—â–µ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ:
// 1) –µ—Å–ª–∏ —Ä–∞–∑–Ω–∏—Ü–∞ >=2 ‚Äî –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –≤ –º–µ–Ω—å—à—É—é –∫–æ–º–∞–Ω–¥—É;
// 2) –∏–Ω–∞—á–µ ‚Äî –Ω–µ–±–æ–ª—å—à–æ–π –ø–µ—Ä–µ–∫–æ—Å 65/35 –≤ –ø–æ–ª—å–∑—É –º–µ–Ω—å—à–µ–π.
function chooseBalancedTeam(){
  const c = getCounts();
  const diff = c.ghosts - c.hunters; // + –∑–Ω–∞—á–∏—Ç –ø—Ä–∏–∑—Ä–∞–∫–æ–≤ –±–æ–ª—å—à–µ
  let team;
  if (diff >= 2) {
    team = 'hunters';
  } else if (diff <= -2) {
    team = 'ghosts';
  } else if (diff > 0) {
    team = Math.random() < 0.65 ? 'hunters' : 'ghosts';
  } else if (diff < 0) {
    team = Math.random() < 0.65 ? 'ghosts' : 'hunters';
  } else {
    team = Math.random() < 0.5 ? 'ghosts' : 'hunters';
  }
  // —Ñ–∏–∫—Å–∏—Ä—É–µ–º
  if (team==='ghosts') c.ghosts++; else c.hunters++;
  setCounts(c);
  return team;
}

function lockUI(lock){ circle.style.pointerEvents = lock ? 'none' : 'auto'; }

function animatePhases(totalMs){
  const steps = [
    '–°–∫–∞–Ω–∏—Ä—É—é –∞—É—Ä—É‚Ä¶', 
    '–†–∞—Å—à–∏—Ñ—Ä–æ–≤—ã–≤–∞—é —Å–∏–º–≤–æ–ª—ã‚Ä¶',
    '–°—Ä–∞–≤–Ω–∏–≤–∞—é —ç–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–∏–π –æ—Ç–ø–µ—á–∞—Ç–æ–∫‚Ä¶',
    `–°–æ–≤–ø–∞–¥–µ–Ω–∏–µ —Å —ç–Ω–µ—Ä–≥–æ–ø–æ–ª–µ–º ‚Äî ${60+Math.floor(Math.random()*35)}%`
  ];
  let i=0, elapsed=0;
  phase.style.display='block';
  progress.style.display='block';
  bar.style.width='0%';
  const tick = 80;
  const timer = setInterval(()=>{
    elapsed += tick;
    const pct = Math.min(100, Math.floor((elapsed/totalMs)*100));
    bar.style.width = pct+'%';
    if (pct> (i+1)*25 && i<steps.length-1) i++;
    phase.textContent = steps[i];
    if (elapsed>=totalMs){ clearInterval(timer); }
  }, tick);
}

function startScan(){
  // reset
  result.style.display='none';
  goBtn.style.display='none';
  again.style.display='none';
  hand.style.display='none';

  spinner.style.display='block';
  animatePhases(2200 + Math.random()*900);
  lockUI(true);

  const dur = 2300 + Math.random()*900;
  setTimeout(()=>{
    const team = chooseBalancedTeam(); // <‚Äî —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –≤—ã–±–æ—Ä

    localStorage.setItem(LS_KEY_TEAM, team);

    spinner.style.display='none';
    phase.style.display='none';
    progress.style.display='none';

    result.className='result '+classFor(team);
    result.textContent = story(team);
    result.style.display='block';

    again.style.display='inline-block';
    goBtn.href = `host.html?team=${team}`;
    goBtn.style.display='inline-block';

    lockUI(false);
  }, dur);
}

circle.addEventListener('click', startScan);
again.addEventListener('click', startScan);

// —Å–∫—Ä—ã—Ç—ã–π —Å–±—Ä–æ—Å (—É–¥–µ—Ä–∂–∞–Ω–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞ ~2 —Å–µ–∫)
let holdTimer=null;
title.addEventListener('pointerdown',()=>{ holdTimer=setTimeout(()=>{ localStorage.removeItem(LS_KEY_COUNTS); alert('–°—á—ë—Ç—á–∏–∫–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å–±—Ä–æ—à–µ–Ω—ã'); },2000); });
title.addEventListener('pointerup',()=> clearTimeout(holdTimer));
title.addEventListener('pointerleave',()=> clearTimeout(holdTimer));

// –ï—Å–ª–∏ –∫–æ–º–∞–Ω–¥–∞ —É–∂–µ –≤—ã–±—Ä–∞–Ω–∞ ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∏ –¥–∞—ë–º –∫–Ω–æ–ø–∫—É
(function init(){
  const team = localStorage.getItem(LS_KEY_TEAM);
  if(team){
    hand.style.display='none';
    result.className='result '+classFor(team);
    result.textContent = story(team);
    result.style.display='block';
    goBtn.href=`host.html?team=${team}`;
    goBtn.style.display='inline-block';
    again.style.display='inline-block';
  }
})();
</script>
</body>
</html>
