<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Halloween Escape ‚Äî –ö–æ–º–∞–Ω–¥–Ω—ã–π —Ä–µ–∂–∏–º</title>
<style>
  :root{
    --bg:#0a0a0e; --panel:#121218; --ink:#f2eddc; --muted:#b7b0a2; --accent:#d4a373;
  }
  *{box-sizing:border-box}
  html,body{height:100%;margin:0;background:var(--bg);color:var(--ink);font-family:Georgia,serif}
  #wrap{position:relative;min-height:100%;display:flex;align-items:center;justify-content:center;
        background-size:cover;background-position:center}
  .shell{width:min(920px,92vw);margin:48px 0;background:rgba(0,0,0,.78);border:1px solid rgba(255,255,255,.08);
         border-radius:16px;box-shadow:0 10px 30px rgba(0,0,0,.45)}
  header{padding:18px 22px;border-bottom:1px solid rgba(255,255,255,.09);display:flex;justify-content:space-between;align-items:center}
  header h1{font-size:20px;margin:0}
  .teamTag{padding:6px 10px;border-radius:10px;border:1px solid rgba(255,255,255,.18);background:rgba(0,0,0,.25);display:none}
  .teamTag.ghost{background:rgba(122,208,255,.18);border-color:rgba(122,208,255,.45)}
  .teamTag.hunters{background:rgba(255,139,106,.18);border-color:rgba(255,139,106,.45)}
  main{padding:22px}
  .title{margin:0 0 8px;font-size:26px}
  .subtitle{margin:0 0 18px;color:var(--muted)}
  .row{display:flex;gap:12px;flex-wrap:wrap;align-items:center}
  .btn{background:var(--accent);color:#1a1510;border:none;border-radius:10px;padding:12px 18px;font-size:16px;cursor:pointer}
  .btn.secondary{background:transparent;color:var(--ink);border:1px solid rgba(255,255,255,.2)}
  .pad{padding:14px 16px;border:1px dashed rgba(255,255,255,.2);border-radius:12px;background:rgba(255,255,255,.04)}
  .field{display:flex;gap:10px;align-items:center;margin-top:10px}
  input[type="text"]{flex:1;min-width:180px;background:#0f0f14;border:1px solid rgba(255,255,255,.22);color:var(--ink);
                     border-radius:10px;padding:12px 14px;font-size:16px}
  .badge{display:inline-block;padding:4px 10px;border-radius:999px;border:1px solid rgba(255,255,255,.16);margin-bottom:10px}
  .lock{display:inline-flex;align-items:center;gap:8px}
  .lock svg{width:20px;height:20px}
  .ok{color:#80ffa6}
  .err{color:#ff9c9c}
  .center{display:flex;gap:12px;flex-wrap:wrap;align-items:center;justify-content:center}
  .bigTeam{font-size:40px;margin:8px 0 2px}
  .teamSplash{padding:26px;border-radius:14px;border:1px solid rgba(255,255,255,.14)}
  .teamSplash.ghost{background:rgba(122,208,255,.15);border-color:rgba(122,208,255,.45)}
  .teamSplash.hunters{background:rgba(255,139,106,.15);border-color:rgba(255,139,106,.45)}
  .fade{animation:fade .5s ease}
  @keyframes fade{from{opacity:0;transform:translateY(8px)}to{opacity:1;transform:translateY(0)}}
</style>
</head>
<body>
<div id="wrap" style="background-image:url('intro.png')">
  <div class="shell fade" id="card">
    <header>
      <h1>–¢–∞–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –¥–æ–º ‚Äî –ö–æ–º–∞–Ω–¥–Ω—ã–π –∫–≤–µ—Å—Ç</h1>
      <div id="teamTag" class="teamTag"></div>
    </header>
    <main id="main"></main>
  </div>
</div>

<script>
const $ = s => document.querySelector(s);
const main = $("#main");
const wrap = $("#wrap");
const teamTag = $("#teamTag");

// –∫–æ–º–∞–Ω–¥—ã
const TEAMS = [
  {name:"–ü—Ä–∏–∑—Ä–∞–∫–∏",   cls:"ghost"},
  {name:"–û—Ö–æ—Ç–Ω–∏–∫–∏",   cls:"hunters"}
];

// —Å—é–∂–µ—Ç–Ω—ã–µ –∫–æ–º–Ω–∞—Ç—ã
const SCENES = [
  { // 0 ‚Äî –ø—Ä–æ–ª–æ–≥
    bg:"intro.png",
    render(){
      return `
        <h2 class="title">–ü–æ–ª—É–Ω–æ—á–Ω—ã–π –ø—Ä–æ–ª–æ–≥</h2>
        <p class="subtitle">
          –ö–æ–≥–¥–∞ —á–∞—Å—ã –ø—Ä–æ–±–∏–ª–∏ –¥–≤–µ–Ω–∞–¥—Ü–∞—Ç—å, –¥–≤–µ—Ä—å –∑–∞—Å–∫—Ä–∏–ø–µ–ª–∞ ‚Äî –∏ –≤—ã —à–∞–≥–Ω—É–ª–∏ –≤–Ω—É—Ç—Ä—å. 
          –î–æ–º –±—É–¥—Ç–æ <i>–æ–∂–∏–ª</i>: —à—ë–ø–æ—Ç –≤ –∫–æ—Ä–∏–¥–æ—Ä–∞—Ö, —Ç–µ–Ω–∏ –∑–∞ —É–≥–ª–æ–º –∏ –∑–∞–º–∫–∏ –Ω–∞ –∫–∞–∂–¥–æ–π –¥–≤–µ—Ä–∏. 
          –í—ã–±–µ—Ä–∏—Ç–µ ¬´–ú–Ω–µ –ø–æ–≤–µ–∑—ë—Ç¬ª ‚Äî –¥–æ–º —Å–∞–º —Ä–∞–∑–¥–µ–ª–∏—Ç –≤–∞—Å –Ω–∞ –∫–æ–º–∞–Ω–¥—ã. 
          –í–∞—à–∞ —Ü–µ–ª—å ‚Äî —É—Å–ø–µ—Ç—å –≤—ã–±—Ä–∞—Ç—å—Å—è –¥–æ —Ç–æ–≥–æ, –∫–∞–∫ —á–∞—Å—ã —Å–Ω–æ–≤–∞ –ø—Ä–æ–±—å—é—Ç –ø–æ–ª–Ω–æ—á—å.
        </p>
        <div class="center">
          <button class="btn" id="lucky">–ú–Ω–µ –ø–æ–≤–µ–∑—ë—Ç</button>
        </div>
      `;
    },
    wire(){
      $("#lucky").onclick = ()=>{
        const t = TEAMS[Math.floor(Math.random()*TEAMS.length)];
        localStorage.setItem("hn_team", JSON.stringify(t));
        showTeamSplash(t);
      };
    }
  },
  { // 1 ‚Äî –±–∏–±–ª–∏–æ—Ç–µ–∫–∞
    bg:"library.png",
    title:"–ö–æ–º–Ω–∞—Ç–∞ 1 ‚Äî –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ —à—ë–ø–æ—Ç–æ–≤",
    lore:`–í –ø—ã–ª–∏ –≤–µ–∫–æ–≤—ã—Ö –ø–æ–ª–æ–∫ –∫—Ç–æ-—Ç–æ –æ—Å—Ç–∞–≤–∏–ª —Ä–∏—Ñ–º–æ–≤–∞–Ω–Ω—É—é –ø–æ–¥—Å–∫–∞–∑–∫—É. 
          –°—Ç—Ä–∞–Ω–∏—Ü—ã —à–µ–ª–µ—Å—Ç—è—Ç, –±—É–¥—Ç–æ –ø–æ–¥—Å–∫–∞–∑—ã–≤–∞—é—Ç —Ç—Ä–∏ –ø–µ—Ä–≤—ã–µ –±—É–∫–≤—ã –∫–ª—é—á–∞‚Ä¶`,
    task:`<b>–û—Ñ–ª–∞–π–Ω-–∑–∞–¥–∞–Ω–∏–µ:</b> –Ω–∞–π–¥–∏—Ç–µ <b>3 –ø—Ä–µ–¥–º–µ—Ç–∞</b>, –Ω–∞—á–∏–Ω–∞—é—â–∏–µ—Å—è –Ω–∞ –±—É–∫–≤—ã <b>–¢</b>, <b>–ö</b> –∏ <b>–í</b>. 
           –°–ª–æ–∂–∏—Ç–µ –∏—Ö –≤ –æ–¥–Ω–æ —Å–ª–æ–≤–æ –∏ —à—ë–ø–æ—Ç–æ–º –ø—Ä–æ–∏–∑–Ω–µ—Å–∏—Ç–µ –µ–≥–æ –≤—Å–µ –≤–º–µ—Å—Ç–µ. 
           –ó–∞—Ç–µ–º –≤–≤–µ–¥–∏—Ç–µ —Å–ª–æ–≤–æ-–∫–ª—é—á, —á—Ç–æ–±—ã ¬´—Å–Ω—è—Ç—å –∑–∞–º–æ–∫¬ª.`,
    inputPlaceholder:"—Å–ª–æ–≤–æ-–∫–ª—é—á‚Ä¶",
    answers:["–¢–´–ö–í–ê","TYKVA"]
  },
  { // 2 ‚Äî –ª–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è
    bg:"alchemy.png",
    title:"–ö–æ–º–Ω–∞—Ç–∞ 2 ‚Äî –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è –∞–ª—Ö–∏–º–∏–∫–∞",
    lore:`–ü—É–∑—ã—Ä—å–∫–∏ –≤ —Ä–µ—Ç–æ—Ä—Ç–∞—Ö –º–µ—Ä—Ü–∞—é—Ç —Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–º. –ù–∞ —Å—Ç–æ–ª–µ –∑–∞–ø–∏—Å–∫–∞: ¬´–°–º–µ—à–∞–π —Ç–æ, —á—Ç–æ –¥–∞—ë—Ç —Å–∏–ª—É –Ω–æ—á–∏¬ª.`,
    task:`–°–æ–±–µ—Ä–∏—Ç–µ ¬´–∑–µ–ª—å–µ –±–æ–¥—Ä–æ—Å—Ç–∏¬ª –∏–∑ <b>—Ç—Ä—ë—Ö –ø—Ä–µ–¥–º–µ—Ç–æ–≤ —Ä–∞–∑–Ω—ã—Ö —Ü–≤–µ—Ç–æ–≤</b>: –æ—Ä–∞–Ω–∂–µ–≤—ã–π, —Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π –∏ —á—ë—Ä–Ω—ã–π. 
           –°–ª–æ–∂–∏—Ç–µ –∏—Ö –≤–º–µ—Å—Ç–µ –∏ –ø—Ä–æ–∏–∑–Ω–µ—Å–∏—Ç–µ –≤—Å–ª—É—Ö <b>–∑–∞–∫–ª–∏–Ω–∞–Ω–∏–µ –∏–∑ 10 —Å–ª–æ–≤</b>. 
           –ü–æ—Å–ª–µ —Ä–∏—Ç—É–∞–ª–∞ –≤–≤–µ–¥–∏—Ç–µ –∫–ª—é—á <i>–≠–õ–ò–ö–°–ò–†</i>.`,
    inputPlaceholder:"–≠–õ–ò–ö–°–ò–†",
    answers:["–≠–õ–ò–ö–°–ò–†","ELIKSIR","ELIXIR","–ï–õ–ò–ö–°–ò–†"]
  },
  { // 3 ‚Äî –∑–µ—Ä–∫–∞–ª—å–Ω—ã–π –∑–∞–ª
    bg:"mirrors.png",
    title:"–ö–æ–º–Ω–∞—Ç–∞ 3 ‚Äî –ó–µ—Ä–∫–∞–ª—å–Ω—ã–π –∑–∞–ª",
    lore:`–û—Ç—Ä–∞–∂–µ–Ω–∏—è –¥–µ–ª–∞—é—Ç —à–∞–≥ –≤–ø–µ—Ä—ë–¥ —Ä–∞–Ω—å—à–µ –≤–∞—Å. –ö–∞–∂–µ—Ç—Å—è, –∑–µ—Ä–∫–∞–ª–∞–º –Ω—É–∂–Ω–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å.`,
    task:`–í—ã–ø–æ–ª–Ω–∏—Ç–µ <b>—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π ¬´—Ç–∞–Ω–µ—Ü –ø—Ä–∏–∑—Ä–∞–∫–æ–≤¬ª 15 —Å–µ–∫—É–Ω–¥</b> –∏ –∑–∞–º—Ä–∏—Ç–µ –≤ –æ–¥–∏–Ω–∞–∫–æ–≤–æ–π –ø–æ–∑–µ. 
           –ü–æ—Ç–æ–º –≤–≤–µ–¥–∏—Ç–µ –∫–ª—é—á <i>–≠–•–û</i> ‚Äî –æ—Ç—Ä–∞–∂–µ–Ω–∏—è –æ—Ç—Å—Ç—É–ø—è—Ç.`,
    inputPlaceholder:"–≠–•–û",
    answers:["–≠–•–û","EHO","ECHO"]
  },
  { // 4 ‚Äî —Ñ–∏–Ω–∞–ª—å–Ω–∞—è –¥–≤–µ—Ä—å
    bg:"door.png",
    title:"–§–∏–Ω–∞–ª—å–Ω–∞—è –¥–≤–µ—Ä—å",
    lore:`–ó–∞–º–æ–∫ –≥–ª—É—Ö–æ –≤–∑–¥—ã—Ö–∞–µ—Ç. –î–æ–º –∂–¥—ë—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–π –∑–Ω–∞–∫.`,
    task:`–û–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –∏–∑–¥–∞–π—Ç–µ <b>—Ç—Ä–∏ —Ä–∞–∑–Ω—ã—Ö –∑–≤—É–∫–∞</b> ‚Äî –≤–µ—Ç–µ—Ä, —Å–∫—Ä–∏–ø –∏ —à–∞–≥–∏. 
           –ü–æ—Å–ª–µ —á–µ–≥–æ –≥—Ä–æ–º–∫–æ –ø—Ä–æ–∏–∑–Ω–µ—Å–∏—Ç–µ –≤—Å–ª—É—Ö —Å–≤–æ—ë –∫–æ–º–∞–Ω–¥–Ω–æ–µ —Å–ª–æ–≤–æ. 
           –ù–∞–∂–º–∏—Ç–µ ¬´–û—Ç–∫—Ä—ã—Ç—å –¥–≤–µ—Ä—å¬ª, –∫–æ–≥–¥–∞ –±—É–¥–µ—Ç–µ –≥–æ—Ç–æ–≤—ã.`,
    buttonOnly:true
  },
  { // 5 ‚Äî —Ñ–∏–Ω–∞–ª
    bg:"door.png",
    win:true
  }
];

let sceneIndex = 0;

function setBG(img){ wrap.style.backgroundImage = `url('${img}')`; }
function normalize(s){
  return (s||"").trim().toUpperCase()
    .replaceAll("–Å","–ï")
    .replaceAll("–ô","–ò");
}

function showTeamSplash(team){
  setBG("intro.png");
  $("#card").classList.add("fade");
  $("#teamTag").style.display="block";
  teamTag.className="teamTag "+team.cls;
  teamTag.textContent="–ö–æ–º–∞–Ω–¥–∞: "+team.name;

  main.innerHTML = `
    <div class="center" style="margin:10px 0 6px">
      <div class="teamSplash ${team.cls}">
        <div class="subtitle">—Ç–≤–æ—è –∫–æ–º–∞–Ω–¥–∞</div>
        <div class="bigTeam">${team.name}</div>
      </div>
    </div>
    <p class="subtitle center" style="margin-top:4px">
      –†–∞–∑–¥–µ–ª–∏—Ç–µ—Å—å –≤ –∫–æ–º–Ω–∞—Ç–µ –ø–æ –∫–æ–º–∞–Ω–¥–∞–º –∏ –¥–µ—Ä–∂–∏—Ç–µ—Å—å –≤–º–µ—Å—Ç–µ ‚Äî –¥–æ–º —Å–ª—ã—à–∏—Ç —Ç–æ–ª—å–∫–æ —Ç–µ—Ö, –∫—Ç–æ –¥–µ–π—Å—Ç–≤—É–µ—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ.
    </p>
    <div class="center" style="margin-top:10px">
      <button class="btn" id="startQuest">–í–æ–π—Ç–∏ –≤ –¥–æ–º</button>
    </div>
  `;
  $("#startQuest").onclick=()=>{ sceneIndex=1; renderScene(); };
}

function renderScene(){
  const s = SCENES[sceneIndex];
  setBG(s.bg);

  if(s?.win){
    main.innerHTML = `
      <h2 class="title">üîì –°–≤–æ–±–æ–¥–∞!</h2>
      <p class="subtitle">–ó–∞–º–æ–∫ –ø–∞–ª, –¥–æ–º –æ—Ç–ø—É—Å—Ç–∏–ª –≤–∞—Å –¥–æ —Å–ª–µ–¥—É—é—â–µ–π –ø–æ–ª—É–Ω–æ—á–∏. 
      –û—Ç–ª–∏—á–Ω–∞—è –∫–æ–º–∞–Ω–¥–Ω–∞—è —Ä–∞–±–æ—Ç–∞ ‚Äî —Å—á–∞—Å—Ç–ª–∏–≤–æ–≥–æ –•—ç–ª–ª–æ—É–∏–Ω–∞! üéÉ</p>
      <div class="center"><a class="btn secondary" href="./">–ù–∞ –≥–ª–∞–≤–Ω—É—é</a></div>
    `;
    return;
  }

  if(sceneIndex===0){
    main.innerHTML = SCENES[0].render();
    SCENES[0].wire();
    return;
  }

  // –∫–æ–º–Ω–∞—Ç–∞
  main.innerHTML = `
    <div class="badge lock">
      <svg viewBox="0 0 24 24" fill="currentColor"><path d="M12 1a5 5 0 00-5 5v3H6a2 2 0 00-2 2v8a2 2 0 002 2h12a2 2 0 002-2v-8a2 2 0 00-2-2h-1V6a5 5 0 00-5-5zm-3 8V6a3 3 0 016 0v3H9z"/></svg>
      –ó–∞–º–æ–∫ –∑–∞–∫—Ä—ã—Ç
    </div>
    <h2 class="title">${s.title}</h2>
    ${s.lore ? `<p class="subtitle">${s.lore}</p>` : ``}
    <p class="subtitle">${s.task}</p>
    ${s.buttonOnly ? `
      <div class="center">
        <button class="btn" id="openDoor">–û—Ç–∫—Ä—ã—Ç—å –¥–≤–µ—Ä—å</button>
      </div>
    ` : `
      <div class="pad">
        <div class="field">
          <input id="code" type="text" placeholder="${s.inputPlaceholder||'–∫–æ–¥‚Ä¶'}" autocomplete="off"/>
          <button class="btn" id="unlock">–û—Ç–∫—Ä—ã—Ç—å</button>
        </div>
        <div id="feedback" class="subtitle" style="min-height:24px;margin-top:8px"></div>
      </div>
    `}
  `;

  if(s.buttonOnly){
    $("#openDoor").onclick=()=>{ sceneIndex++; renderScene(); };
  }else{
    $("#unlock").onclick = ()=>{
      const val = normalize($("#code").value);
      const ok = (s.answers||[]).some(a=>normalize(a)===val);
      const fb = $("#feedback");
      if(ok){
        fb.innerHTML = `<span class="ok">‚úÖ –ó–∞–º–æ–∫ —â—ë–ª–∫–Ω—É–ª. –î–∞–ª—å—à–µ!</span>`;
        setTimeout(()=>{ sceneIndex++; renderScene(); }, 550);
      }else{
        fb.innerHTML = `<span class="err">‚úñ –ù–µ–≤–µ—Ä–Ω–æ. –î–æ–º –ª—é–±–∏—Ç —Ç–æ—á–Ω—ã–µ —Å–ª–æ–≤–∞-–∫–ª—é—á–∏.</span>`;
      }
    };
  }
}

// init
(function init(){
  const saved = localStorage.getItem("hn_team");
  if(saved){
    const t = JSON.parse(saved);
    teamTag.style.display="block";
    teamTag.className="teamTag "+t.cls;
    teamTag.textContent="–ö–æ–º–∞–Ω–¥–∞: "+t.name;
    sceneIndex = 1; renderScene();
  }else{
    sceneIndex = 0; renderScene();
  }
})();
</script>
</body>
</html>
