<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>–¢–∞–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –¥–æ–º ‚Äî –∫–æ–º–∞–Ω–¥–Ω—ã–π –∫–≤–µ—Å—Ç</title>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;800;900&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#0b0f14; --panel:#131823; --muted:#aeb4c2; --accent:#ffb703;
  --ok:#66e3ff; --hun:#ffd166; --good:#19c37d; --bad:#ff5252;
}
*{box-sizing:border-box}
body{margin:0;background:#0b0f14;color:#fff;font-family:'Montserrat',sans-serif}
.wrap{max-width:920px;margin:0 auto;padding:16px 16px 80px}
.header{display:flex;align-items:center;gap:12px;margin:6px 0 18px}
.title{font-size:clamp(22px,4.4vw,34px);font-weight:900;line-height:1.15}
.pill{margin-left:auto;padding:8px 14px;border-radius:999px;font-weight:800;background:#202638}
.pill.ghost{color:#032e34;background:linear-gradient(90deg,#66e3ff,#7df3ff)}
.pill.hunter{color:#3b2b00;background:linear-gradient(90deg,#ffd166,#ffe08a)}
.btn{border:0;border-radius:12px;padding:12px 16px;font-weight:800;cursor:pointer}
.btn-start{background:var(--accent);color:#000}
.btn-reset{background:#2a2f42;color:#fff}
.grid{display:grid;gap:18px}
.card{
  background:linear-gradient(180deg,#171b27 0%,#101522 100%);
  border:1px solid rgba(255,255,255,.06);
  border-radius:18px; overflow:hidden;
  box-shadow:0 10px 40px rgba(0,0,0,.35);
}
.card-img{width:100%;display:block;aspect-ratio:16/9;object-fit:cover;background:#0f1422}
.card-body{padding:18px 18px 22px}
.card h2{margin:0 0 8px;font-size:clamp(20px,3.8vw,28px);font-weight:900}
.muted{color:var(--muted)}
ul{margin:10px 0 18px}
.cta{display:flex;gap:12px;flex-wrap:wrap}
a{color:#9ad0ff}
.hidden{display:none !important}
.hr{border-top:1px solid rgba(255,255,255,.08);margin:16px 0}
.input{width:100%;padding:12px 14px;border-radius:10px;border:1px solid rgba(255,255,255,.12);background:#0f1422;color:#fff}
.ok{color:var(--good)} .bad{color:var(--bad)}
.hold{position:relative}
.hold .hint{font-size:13px;color:#aeb4c2;margin-top:6px}
.holdbtn{position:relative}
.hold-progress{position:absolute;left:0;top:0;height:100%;width:0%;background:rgba(0,0,0,.1)}
.center{text-align:center}
</style>
</head>
<body>
<div class="wrap">

  <div class="header">
    <div class="title">–¢–∞–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –¥–æ–º ‚Äî<br/>–ö–æ–º–∞–Ω–¥–Ω—ã–π –∫–≤–µ—Å—Ç</div>
    <button id="startBtn" class="btn btn-start">–°—Ç–∞—Ä—Ç</button>
    <button id="resetBtn" class="btn btn-reset">–°–±—Ä–æ—Å</button>
    <div id="teamPill" class="pill hidden"></div>
  </div>

  <!-- –í—Å—Ç—É–ø–ª–µ–Ω–∏–µ -->
  <div class="card" id="introCard">
    <img src="intro.png" alt="–¢–∞–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –¥–æ–º" class="card-img" loading="lazy">
    <div class="card-body">
      <p class="muted" style="margin-top:0">
        –≠—Ç–æ—Ç –¥–æ–º —Å—Ç–æ–∏—Ç –Ω–∞ —Ö–æ–ª–º–µ —É–∂–µ —Å–æ—Ç–Ω–∏ –ª–µ—Ç. –ù–∏–∫—Ç–æ –Ω–µ –ø–æ–º–Ω–∏—Ç, –∫—Ç–æ –µ–≥–æ –ø–æ—Å—Ç—Ä–æ–∏–ª. –ù–æ –∫–∞–∂–¥—ã–π –•—ç–ª–ª–æ—É–∏–Ω –µ–≥–æ –æ–∫–Ω–∞ –≤—Å–ø—ã—Ö–∏–≤–∞—é—Ç –æ–≥–Ω—ë–º, –∞ –¥–≤–µ—Ä–∏ –æ—Ç–∫—Ä—ã–≤–∞—é—Ç—Å—è ‚Äî –ª–∏—à—å –¥–ª—è —Ç–µ—Ö, –∫—Ç–æ –æ—Å–º–µ–ª–∏—Ç—Å—è –≤–æ–π—Ç–∏. 
        –°–Ω–∞—á–∞–ª–∞ –¥–æ–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç –≤–∞—Å –Ω–∞ –∫–æ–º–∞–Ω–¥—ã, –∞ –∑–∞—Ç–µ–º –≤–ø—É—Å—Ç–∏—Ç –≤ —Å–≤–æ–∏ –∫–æ–º–Ω–∞—Ç—ã‚Ä¶ —á—Ç–æ–±—ã –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —Å—É–º–µ–µ—Ç–µ –ª–∏ –≤—ã –æ—Ç–∫—Ä—ã—Ç—å –ü–æ—Å–ª–µ–¥–Ω—é—é –î–≤–µ—Ä—å. 
        –°–ø—Ä–∞–≤–µ–¥–ª–∏–≤–æ–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –¥–µ–ª–∞–µ—Ç <a href="team.html"><b>—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç–µ–ª—å</b></a>.
      </p>
      <div id="chooseTeam" class="cta">
        <button class="btn btn-reset" data-choose="ghosts">üëª –Ø ‚Äî –ü–†–ò–ó–†–ê–ö</button>
        <button class="btn btn-reset" data-choose="hunters">üéØ –Ø ‚Äî –û–•–û–¢–ù–ò–ö</button>
      </div>
      <p id="hintChosen" class="muted hidden">–ö–æ–º–∞–Ω–¥–∞ –≤—ã–±—Ä–∞–Ω–∞. –ù–∞–∂–º–∏—Ç–µ ¬´–°—Ç–∞—Ä—Ç¬ª, —á—Ç–æ–±—ã –≤–æ–π—Ç–∏ –≤ –¥–æ–º.</p>
    </div>
  </div>

  <div class="grid">

    <!-- –ö–æ–º–Ω–∞—Ç–∞ 1. –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ -->
    <div class="card hidden" id="room1">
      <img src="library.png" alt="–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞" class="card-img">
      <div class="card-body">
        <h2>–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞</h2>
        <p class="muted">
          –ü–æ–ª–∫–∏ –¥–æ –ø–æ—Ç–æ–ª–∫–∞, –∫–∞—Ä—Ç–æ—á–Ω—ã–π –∫–∞—Ç–∞–ª–æ–≥ –∏ —Å–∫—Ä–∏–ø –ø–µ—Ä—å–µ–≤–æ–π —Ä—É—á–∫–∏. –ù–∞ —Å—Ç–æ–ª–µ –∑–∞–ø–∏—Å–∫–∞: 
          ¬´–ö–ª—é—á ‚Äî –≤ –ø–µ—Ä–≤—ã—Ö –±—É–∫–≤–∞—Ö –Ω–∞–π–¥–µ–Ω–Ω–æ–≥–æ¬ª.
        </p>

        <div id="listWrap1">
          <p><b>–ù–∞–π–¥–∏—Ç–µ –∏ —Å–æ–±–µ—Ä–∏—Ç–µ –ø–µ—Ä–µ–¥ —Å–æ–±–æ–π —ç—Ç–∏ 5 –ø—Ä–µ–¥–º–µ—Ç–æ–≤ (–≤ –ª—é–±–æ–º –ø–æ—Ä—è–¥–∫–µ):</b></p>
          <ul id="itemsList"></ul>
          <button id="itemsDone" class="btn btn-start">–ü—Ä–µ–¥–º–µ—Ç—ã —Å–æ–±—Ä–∞–Ω—ã</button>
        </div>

        <div id="passwordWrap1" class="hidden">
          <p class="muted">–°–ª–æ–∂–∏—Ç–µ –ø–µ—Ä–≤—ã–µ –±—É–∫–≤—ã —Å–æ–±—Ä–∞–Ω–Ω—ã—Ö –ø—Ä–µ–¥–º–µ—Ç–æ–≤ –∏ –≤–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å –∏–∑ 5 –±—É–∫–≤.</p>
          <input id="pass1" class="input" placeholder="–ø–∞—Ä–æ–ª—å –∏–∑ 5 –±—É–∫–≤" maxlength="12">
          <div class="cta">
            <button id="check1" class="btn btn-start">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
          </div>
          <p id="msg1" class="muted"></p>
        </div>

        <p class="muted" id="progress1">–ö–æ–º–Ω–∞—Ç–∞ 1 –∏–∑ 4</p>
      </div>
    </div>

    <!-- –ö–æ–º–Ω–∞—Ç–∞ 2. –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è –∞–ª—Ö–∏–º–∏–∫–∞ -->
    <div class="card hidden" id="room2">
      <img src="alchemy.png" alt="–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è –∞–ª—Ö–∏–º–∏–∫–∞" class="card-img">
      <div class="card-body">
        <h2>–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è –∞–ª—Ö–∏–º–∏–∫–∞</h2>
        <p class="muted">
          –°–∏—è—é—Ç –∫–æ–ª–±—ã, –ø–∞—Ö–Ω–µ—Ç –ø–æ—Ä–æ—à–∫–∞–º–∏ –∏ —Ç—Ä–∞–≤–∞–º–∏. –ù–∞ –ø–æ–ª–∫–µ —á–µ—Ä–Ω–∏–ª—å–Ω–∞—è –∫–ª—è–∫—Å–∞ —Å–∫–ª–∞–¥—ã–≤–∞–µ—Ç—Å—è –≤ —Å—Ç—Ä–æ–∫–∏ —Ä–µ—Ü–µ–ø—Ç–∞ ‚Äî –¥–æ–º –∂–¥—ë—Ç —Å–æ–≤–º–µ—Å—Ç–Ω–æ–≥–æ –ø—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è.
        </p>
        <div class="hr"></div>
        <p><b>–°–≤–∞—Ä–∏—Ç–µ ¬´–≠–ª–∏–∫—Å–∏—Ä –û—Å–µ–Ω–Ω–µ–≥–æ –¢–µ–ø–ª–∞¬ª:</b></p>
        <ul class="muted">
          <li>–ö—Ä—É–∂–∫–∞ <b>–≥–æ—Ä—è—á–µ–≥–æ —á–∞—è</b> (—á—ë—Ä–Ω—ã–π –∏–ª–∏ —Ç—Ä–∞–≤—è–Ω–æ–π).</li>
          <li>–î–æ–±–∞–≤—å—Ç–µ <b>—è–≥–æ–¥—ã</b> –∏–ª–∏ <b>–ª–æ–∂–∫—É –≤–∞—Ä–µ–Ω—å—è</b>.</li>
          <li>–†–∞–∑–º–µ—à–∞–π—Ç–µ <b>–ª–æ–∂–∫—É –º—ë–¥–∞</b>.</li>
          <li><b>–©–µ–ø–æ—Ç–∫–∞</b> –∫–æ—Ä–∏—Ü—ã –∏–ª–∏ –∏–º–±–∏—Ä—è.</li>
          <li>–ü–æ –∂–µ–ª–∞–Ω–∏—é ‚Äî –Ω–µ–º–Ω–æ–≥–æ <b>–º–æ–ª–æ–∫–∞</b>.</li>
        </ul>
        <div class="hold">
          <button id="hold2" class="btn btn-start holdbtn">–í–µ–¥—É—â–∞—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç</button>
          <div id="hold2bar" class="hold-progress"></div>
          <div class="hint">–ù–∞–∂–º–∏—Ç–µ –∏ —É–¥–µ—Ä–∂–∏–≤–∞–π—Ç–µ 2 —Å–µ–∫—É–Ω–¥—ã.</div>
        </div>
        <p class="muted" id="progress2">–ö–æ–º–Ω–∞—Ç–∞ 2 –∏–∑ 4</p>
      </div>
    </div>

    <!-- –ö–æ–º–Ω–∞—Ç–∞ 3. –ó–∞–ª –∑–µ—Ä–∫–∞–ª -->
    <div class="card hidden" id="room3">
      <img src="mirrors.png" alt="–ó–∞–ª –∑–µ—Ä–∫–∞–ª" class="card-img">
      <div class="card-body">
        <h2>–ó–∞–ª –∑–µ—Ä–∫–∞–ª</h2>
        <p class="muted">
          –û—Ç—Ä–∞–∂–µ–Ω–∏—è –º–Ω–æ–∂–∞—Ç—Å—è –∏ –ø–µ—Ä–µ—à—ë–ø—Ç—ã–≤–∞—é—Ç—Å—è. –ö–∞–∂–µ—Ç—Å—è, —á—Ç–æ –∑–µ—Ä–∫–∞–ª–∞ –∑–∞–ø–æ–º–∏–Ω–∞—é—Ç –¥–≤–∏–∂–µ–Ω–∏—è.
        </p>
        <p><b>–ó–∞–¥–∞–Ω–∏–µ:</b> –ø–µ—Ä–≤—ã–π –∏–≥—Ä–æ–∫ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ—Ä–æ—Ç–∫–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ. –°–ª–µ–¥—É—é—â–∏–π –∏–≥—Ä–æ–∫ –∫–æ–º–∞–Ω–¥—ã –ø–æ–≤—Ç–æ—Ä—è–µ—Ç –¥–≤–∏–∂–µ–Ω–∏–µ –ø–µ—Ä–≤–æ–≥–æ –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç —Å–≤–æ—ë. –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ, –ø–æ–∫–∞ –≤—Å–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏ –Ω–µ –≤–Ω–µ—Å—É—Ç –≤–∫–ª–∞–¥. –ß—Ç–æ–±—ã –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥, <b>–ø–æ–∫–∞–∂–∏—Ç–µ –≤–µ–¥—É—â–µ–π –≤—Å—é —Ü–µ–ø–æ—á–∫—É –¥–≤–∏–∂–µ–Ω–∏–π —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ</b>.</p>
        <div class="hold">
          <button id="hold3" class="btn btn-start holdbtn">–í–µ–¥—É—â–∞—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç</button>
          <div id="hold3bar" class="hold-progress"></div>
          <div class="hint">–ù–∞–∂–º–∏—Ç–µ –∏ —É–¥–µ—Ä–∂–∏–≤–∞–π—Ç–µ 2 —Å–µ–∫—É–Ω–¥—ã.</div>
        </div>
        <p class="muted" id="progress3">–ö–æ–º–Ω–∞—Ç–∞ 3 –∏–∑ 4</p>
      </div>
    </div>

    <!-- –ö–æ–º–Ω–∞—Ç–∞ 4. –§–∏–Ω–∞–ª—å–Ω–∞—è –¥–≤–µ—Ä—å -->
    <div class="card hidden" id="room4">
      <img src="door.png" alt="–§–∏–Ω–∞–ª—å–Ω–∞—è –¥–≤–µ—Ä—å" class="card-img">
      <div class="card-body">
        <h2>–§–∏–Ω–∞–ª—å–Ω–∞—è –¥–≤–µ—Ä—å</h2>
        <p class="muted">–¢—Ä–∏ –∑–∞–º–∫–∞ ‚Äî —Ç—Ä–∏ –∑–∞–≥–∞–¥–∫–∏. –û—Ç–∫—Ä–æ–π—Ç–µ –∏—Ö –≤—Å–µ, –∏ –¥–≤–µ—Ä—å —Ä–∞—Å–ø–∞—Ö–Ω—ë—Ç—Å—è.</p>

        <div class="hr"></div>

        <p><b>–ó–∞–º–æ–∫ 1.</b> ¬´–ë–µ–∑ —è–∑—ã–∫–∞ –≥–æ–≤–æ—Ä–∏—Ç, –±–µ–∑ —É—à–µ–π —Å–ª—ã—à–∏—Ç. –ì–æ–≤–æ—Ä–∏—Ç, –∫–æ–≥–¥–∞ –∫ –Ω–µ–º—É –≥–æ–≤–æ—Ä—è—Ç. –ß—Ç–æ —ç—Ç–æ?¬ª</p>
        <input id="lock1" class="input" placeholder="–æ—Ç–≤–µ—Ç">
        <p id="lock1msg" class="muted"></p>

        <div class="hr"></div>

        <p><b>–ó–∞–º–æ–∫ 2.</b> ¬´–ü–æ—è–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ —Å–≤–µ—Ç–µ –∏ –∏—Å—á–µ–∑–∞–µ—Ç –≤ —Ç–µ–º–Ω–æ—Ç–µ. –í—Å–µ–≥–¥–∞ —Å–ª–µ–¥—É–µ—Ç –∑–∞ —Ç–æ–±–æ–π. –ß—Ç–æ —ç—Ç–æ?¬ª</p>
        <input id="lock2" class="input" placeholder="–æ—Ç–≤–µ—Ç">
        <p id="lock2msg" class="muted"></p>

        <div class="hr"></div>

        <p><b>–ó–∞–º–æ–∫ 3.</b> ¬´<i>–û–Ω–æ –∏–¥—ë—Ç –≤–ø–µ—Ä—ë–¥</i>, –Ω–æ –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ —à–∞–≥–∞–µ—Ç; –µ–≥–æ –Ω–µ–ª—å–∑—è –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å. –ß—Ç–æ —ç—Ç–æ?¬ª</p>
        <input id="lock3" class="input" placeholder="–æ—Ç–≤–µ—Ç">
        <p id="lock3msg" class="muted"></p>

        <div class="cta">
          <button id="openDoor" class="btn btn-start">–û—Ç–∫—Ä—ã—Ç—å –¥–≤–µ—Ä—å</button>
        </div>

        <p class="muted" id="progress4">–ö–æ–º–Ω–∞—Ç–∞ 4 –∏–∑ 4</p>
      </div>
    </div>

    <!-- –§–∏–Ω–∞–ª -->
    <div class="card hidden" id="finalCard">
      <img src="door.png" alt="–û—Ç–∫—Ä—ã—Ç–∞—è –¥–≤–µ—Ä—å" class="card-img">
      <div class="card-body center">
        <h2 id="finalTitle">–î–≤–µ—Ä—å —Ä–∞—Å–ø–∞—Ö–Ω—É–ª–∞—Å—å!</h2>
        <p class="muted" id="finalText">–î–æ–º –ø—Ä–∏–Ω—è–ª –≤–∞—à—É —Å–º–µ–ª–æ—Å—Ç—å –∏ —Å–º–µ–∫–∞–ª–∫—É. –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞, –∫–æ–º–∞–Ω–¥–∞!</p>
        <p class="muted">–ö–æ–º–∞–Ω–¥–∞: <b id="finalTeam"></b></p>
        <div class="cta center">
          <a class="btn btn-reset" href="index.html">–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–µ–Ω—é</a>
        </div>
      </div>
    </div>

  </div>
</div>

<script>
const $ = (sel)=>document.querySelector(sel);
const show = (id, on=true)=>{ const el = typeof id==='string' ? $(id) : id; if(!el)return; on? el.classList.remove('hidden'):el.classList.add('hidden'); };
const byId=(id)=>document.getElementById(id);

// --- –∫–æ–º–∞–Ω–¥–∞ –∏–∑ query/localStorage ---
const TEAM_KEY='hn_team';
const getTeamFromQuery=()=> new URLSearchParams(location.search).get('team');
function readTeam(){
  const q=getTeamFromQuery();
  if(q){ localStorage.setItem(TEAM_KEY,q); return q; }
  const s=localStorage.getItem(TEAM_KEY);
  return s||null;
}
function teamLabel(t){ return t==='ghosts'?'–û–•–û–¢–ù–ò–ö–ò'&&'–ü–†–ò–ó–†–ê–ö–ò':'–û–•–û–¢–ù–ò–ö–ò'; }
function teamPillApply(t){
  const pill=byId('teamPill');
  pill.textContent = (t==='ghosts'?'–ü–†–ò–ó–†–ê–ö–ò':'–û–•–û–¢–ù–ò–ö–ò');
  pill.classList.toggle('ghost',t==='ghosts');
  pill.classList.toggle('hunter',t==='hunters');
  show(pill,true);
}

// --- —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–æ–º–Ω–∞—Ç ---
let current=0; // 0-intro,1..4 –∫–æ–º–Ω–∞—Ç—ã,5 —Ñ–∏–Ω–∞–ª
function go(n){
  current=n;
  // —Å–ø—Ä—è—Ç–∞—Ç—å –≤—Å—ë
  ['introCard','room1','room2','room3','room4','finalCard'].forEach(id=>show('#'+id,false));
  // –ø–æ–∫–∞–∑–∞—Ç—å –Ω—É–∂–Ω–æ–µ
  const map={0:'introCard',1:'room1',2:'room2',3:'room3',4:'room4',5:'finalCard'};
  show('#'+map[n],true);
  window.scrollTo({top:0,behavior:'smooth'});
}

// --- –≤—ã–±–æ—Ä –∫–æ–º–∞–Ω–¥—ã –≤–Ω—É—Ç—Ä–∏ host (–µ—Å–ª–∏ –Ω–µ—Ç –∑–∞—Ä–∞–Ω–µ–µ) ---
const storedTeam = readTeam();
if(storedTeam){
  teamPillApply(storedTeam);
  show('#chooseTeam',false);
  show('#hintChosen',true);
}else{
  // –≤—ã–±–æ—Ä
  document.querySelectorAll('[data-choose]').forEach(btn=>{
    btn.addEventListener('click',()=>{
      const t=btn.dataset.choose;
      localStorage.setItem(TEAM_KEY,t);
      teamPillApply(t);
      show('#chooseTeam',false);
      show('#hintChosen',true);
    });
  });
}

// --- –°—Ç–∞—Ä—Ç/–°–±—Ä–æ—Å ---
byId('startBtn').addEventListener('click',()=>go(1));
byId('resetBtn').addEventListener('click',()=>{
  // –ø—Ä–æ–≥—Ä–µ—Å—Å –∫–æ–º–Ω–∞—Ç —Ç–æ–ª—å–∫–æ –¥–ª—è —ç—Ç–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
  sessionStorage.clear();
  go(0);
});

// ================= –ö–æ–º–Ω–∞—Ç–∞ 1 =================
const ITEMS_SRC = ['–ò–≥—Ä—É—à–∫–∞','–ù–æ—Å–æ–∫','–ê–ª—å–±–æ–º','–ì–∞–ª—Å—Ç—É–∫','–ö—Ä—É–∂–∫–∞']; // –ö –ù –ò –ì –ê (–ø–µ—Ä–µ–º–µ—à–∏–≤–∞–µ–º)
function shuffle(a){ for(let i=a.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [a[i],a[j]]=[a[j],a[i]]; } return a; }
function renderItems(){
  const list=byId('itemsList');
  list.innerHTML='';
  shuffle([...ITEMS_SRC]).forEach(it=>{
    const li=document.createElement('li'); li.textContent=it; list.appendChild(li);
  });
}
renderItems();

byId('itemsDone').addEventListener('click',()=>{
  show('#listWrap1',false);
  show('#passwordWrap1',true);
});

function norm(s){ return (s||'').toLowerCase().replace(/—ë/g,'–µ').trim(); }
byId('check1').addEventListener('click',()=>{
  const val = norm(byId('pass1').value);
  const ok = val==='–∫–Ω–∏–≥–∞';
  const msg=byId('msg1');
  if(ok){ msg.innerHTML='<span class="ok">–í–µ—Ä–Ω–æ! –ü–æ–ª–∫–∞ –¥—Ä–æ–≥–Ω—É–ª–∞ –∏ –æ—Ç–∫—Ä—ã–ª–∞ –ø—Ä–æ—Ö–æ–¥‚Ä¶</span>'; setTimeout(()=>go(2),600); }
  else { msg.innerHTML='<span class="bad">–ù–µ—Ç, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë. –ü–∞—Ä–æ–ª—å ‚Äî –∏–∑ –ø–µ—Ä–≤—ã—Ö –±—É–∫–≤ –ø—Ä–µ–¥–º–µ—Ç–æ–≤.</span>'; }
});

// ================= –ö–æ–º–Ω–∞—Ç–∞ 2 =================
function holdToConfirm(btnId,barId,onDone){
  const btn=byId(btnId), bar=byId(barId);
  let t; let p=0; let int;
  const start=()=>{ p=0; bar.style.width='0%'; t=setTimeout(()=>{},0); int=setInterval(()=>{ p+=10; bar.style.width=p+'%'; if(p>=100){ clearInterval(int); onDone(); }},200); };
  const stop = ()=>{ clearInterval(int); bar.style.width='0%'; };
  btn.addEventListener('pointerdown',e=>{btn.setPointerCapture(e.pointerId); start();});
  btn.addEventListener('pointerup',stop);
  btn.addEventListener('pointercancel',stop);
  btn.addEventListener('pointerleave',stop);
}

holdToConfirm('hold2','hold2bar',()=>{ go(3); });

// ================= –ö–æ–º–Ω–∞—Ç–∞ 3 =================
holdToConfirm('hold3','hold3bar',()=>{ go(4); });

// ================= –ö–æ–º–Ω–∞—Ç–∞ 4 =================
function checkLock(inputId, okWords, msgId){
  const s = norm(byId(inputId).value);
  const ok = okWords.some(w=>norm(w)===s);
  byId(msgId).textContent = ok ? '–≤–µ—Ä–Ω–æ' : '';
  return ok;
}

byId('openDoor').addEventListener('click',()=>{
  const ok1 = checkLock('lock1',['—ç—Ö–æ'],'lock1msg');      // —ç—Ö–æ
  const ok2 = checkLock('lock2',['—Ç–µ–Ω—å'],'lock2msg');     // —Ç–µ–Ω—å
  const ok3 = checkLock('lock3',['–≤—Ä–µ–º—è'],'lock3msg');    // –≤—Ä–µ–º—è
  if(ok1 && ok2 && ok3){
    // —Ñ–∏–Ω–∞–ª
    go(5);
    const t = readTeam() || 'ghosts';
    byId('finalTeam').textContent = t==='ghosts'?'–ü–†–ò–ó–†–ê–ö–ò':'–û–•–û–¢–ù–ò–ö–ò';
  }else{
    // –ø–æ–¥—Å–∫–∞–∑–∫–∞ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –≤–≤–µ–¥–µ–Ω–æ –∏ –Ω–µ–≤–µ—Ä–Ω–æ
    ['lock1','lock2','lock3'].forEach((id,i)=>{
      const el=byId(id);
      if(norm(el.value).length>0){
        const msg=byId(['lock1msg','lock2msg','lock3msg'][i]);
        msg.innerHTML='<span class="bad">–ù–µ–≤–µ—Ä–Ω–æ. –ü–æ–¥—É–º–∞–π—Ç–µ –µ—â—ë.</span>';
      }
    });
  }
});

// –ø–æ–∫–∞–∑–∞—Ç—å –Ω–∞—á–∞–ª—å–Ω—É—é –∫–∞—Ä—Ç—É
go(0);
</script>
</body>
</html>
