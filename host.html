<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>–¢–∞–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –¥–æ–º ‚Äî –ö–æ–º–∞–Ω–¥–Ω—ã–π –∫–≤–µ—Å—Ç</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#0f1115; --card:#1a1f27; --muted:#9aa4b2; --ink:#e8edf4; --accent:#ffb703;
      --accent2:#3ddc97; --bad:#ff5c7a; --good:#32d74b; --brand:#5ac8fa;
    }
    *{box-sizing:border-box}
    html,body{margin:0;background:var(--bg);color:var(--ink);font-family:Montserrat,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif}
    .wrap{max-width:960px;margin:0 auto;padding:16px 14px 80px}
    header{display:flex;align-items:center;gap:12px;justify-content:space-between;margin-bottom:14px}
    .title{font-weight:800;font-size:22px;line-height:1.2}
    .team-pill{padding:8px 14px;border-radius:999px;background:#251d27;border:1px solid #3a2b3e;font-weight:800}
    .team-ghost{box-shadow:0 0 0 2px #5a3d7a inset}
    .team-hunter{box-shadow:0 0 0 2px #2f6a9a inset}
    .actions{display:flex;gap:10px}
    .btn{appearance:none;border:none;padding:10px 16px;border-radius:12px;font-weight:700;cursor:pointer}
    .btn--start{background:var(--accent);color:#1a1200}
    .btn--reset{background:#2a2f38;color:var(--ink)}
    .card{background:var(--card);border:1px solid #242a34;border-radius:18px;overflow:hidden;margin:14px 0}
    .card-header img{width:100%;height:220px;object-fit:cover;background:#0b0d11}
    .card-body{padding:18px}
    h2{margin:0 0 14px 0;font-size:26px}
    p{color:var(--ink);opacity:.92;margin:0 0 12px 0}
    ul{margin:12px 0 16px 22px}
    .hint{color:var(--muted);font-size:14px;margin-top:8px}
    .hidden{display:none !important}
    .success{border:1px solid rgba(50,215,75,.35);box-shadow:0 0 0 2px rgba(50,215,75,.12) inset}
    .fail{border:1px solid rgba(255,92,122,.3);box-shadow:0 0 0 2px rgba(255,92,122,.1) inset}
    .input{width:100%;padding:12px 14px;border-radius:12px;border:1px solid #303845;background:#12161c;color:var(--ink);font-size:16px}
    .row{display:flex;gap:12px;flex-wrap:wrap}
    .row .btn{flex:1}
    .footer{padding:16px 0 4px;color:var(--muted);text-align:center}
    .hold-hint{display:none} /* –ø–æ–¥—Å–∫–∞–∑–∫—É –ø—Ä–æ —É–¥–µ—Ä–∂–∞–Ω–∏–µ —Å–∫—Ä—ã–≤–∞–µ–º */
    .choice{display:flex;flex-direction:column;gap:12px}
    .btn-ghost{background:#251d27;border:1px solid #3f2f52}
    .btn-hunter{background:#16212a;border:1px solid #23465e}
    .pill{display:inline-block;padding:4px 10px;border-radius:999px;background:#222a33;color:var(--muted);font-size:12px}
    .riddle{margin:8px 0}
    .riddle .input{margin-top:6px}
    .center{text-align:center}
    a.btn-link{display:inline-block;text-decoration:none}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="title">–¢–∞–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –¥–æ–º ‚Äî <br/>–ö–æ–º–∞–Ω–¥–Ω—ã–π –∫–≤–µ—Å—Ç</div>
      <div class="actions">
        <div id="teamPill" class="team-pill hidden"></div>
        <button id="startBtn" class="btn btn--start">–°—Ç–∞—Ä—Ç</button>
        <button id="resetBtn" class="btn btn--reset">–°–±—Ä–æ—Å</button>
      </div>
    </header>

    <!-- –í—Å—Ç—É–ø–ª–µ–Ω–∏–µ -->
    <section id="intro" class="card">
      <div class="card-header"><img src="intro.png" alt="–ú–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –¥–æ–º –ø–æ–¥ –ª—É–Ω–æ–π" /></div>
      <div class="card-body">
        <h2>–î–æ–º –Ω–∞ —Ö–æ–ª–º–µ</h2>
        <p>
          –≠—Ç–æ—Ç –¥–æ–º —Å—Ç–æ–∏—Ç –Ω–∞ —Ö–æ–ª–º–µ —É–∂–µ —Å–æ—Ç–Ω–∏ –ª–µ—Ç. –ù–∏–∫—Ç–æ –Ω–µ –ø–æ–º–Ω–∏—Ç, –∫—Ç–æ –µ–≥–æ –ø–æ—Å—Ç—Ä–æ–∏–ª.
          –ù–æ –∫–∞–∂–¥—ã–π –•—ç–ª–ª–æ—É–∏–Ω –µ–≥–æ –æ–∫–Ω–∞ –≤—Å–ø—ã—Ö–∏–≤–∞—é—Ç –æ–≥–Ω—ë–º, –∞ –¥–≤–µ—Ä–∏ –æ—Ç–∫—Ä—ã–≤–∞—é—Ç—Å—è ‚Äî —Ç–æ–ª—å–∫–æ —Ç–µ–º,
          –∫—Ç–æ –æ—Å–º–µ–ª–∏—Ç—Å—è –≤–æ–π—Ç–∏. –î–æ–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç –≤–∞—Å –Ω–∞ –∫–æ–º–∞–Ω–¥—ã –∏ –≤–ø—É—Å—Ç–∏—Ç –≤ –∫–æ–º–Ω–∞—Ç—ã‚Ä¶
          –°—É–º–µ–µ—Ç–µ –ª–∏ –≤—ã –æ—Ç–∫—Ä—ã—Ç—å –ü–æ—Å–ª–µ–¥–Ω—é—é –î–≤–µ—Ä—å?
        </p>
        <p class="hint">–°–æ–≤–µ—Ç: —Ä–∞–∑–±–µ–π—Ç–µ—Å—å –Ω–∞ –∫–æ–º–∞–Ω–¥—ã, –∫–∞–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –Ω–∞ —ç–∫—Ä–∞–Ω–µ –∫–∞–∂–¥–æ–≥–æ –∏–≥—Ä–æ–∫–∞.</p>
        <div id="teamChoice" class="choice hidden" style="margin-top:10px">
          <span class="pill">–ö–æ–º–∞–Ω–¥–∞ –Ω–µ –≤—ã–±—Ä–∞–Ω–∞</span>
          <div class="row">
            <button class="btn btn-ghost" data-choose="ghost">üëª –Ø ‚Äî –ü—Ä–∏–∑—Ä–∞–∫</button>
            <button class="btn btn-hunter" data-choose="hunter">üéØ –Ø ‚Äî –û—Ö–æ—Ç–Ω–∏–∫</button>
          </div>
        </div>
      </div>
    </section>

    <!-- –ö–æ–º–Ω–∞—Ç–∞ 1 -->
    <section id="room1" class="card hidden">
      <div class="card-header"><img src="library.png" alt="–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞" /></div>
      <div class="card-body">
        <h2>–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞</h2>
        <p>
          –ü–æ–ª–∫–∏ –¥–æ –ø–æ—Ç–æ–ª–∫–∞, –∫–∞—Ä—Ç–æ—á–Ω—ã–π –∫–∞—Ç–∞–ª–æ–≥ –∏ —Å–∫—Ä–∏–ø –ø–µ—Ä—å–µ–≤–æ–π —Ä—É—á–∫–∏. –ù–∞ —Å—Ç–æ–ª–µ –∑–∞–ø–∏—Å–∫–∞:
          ¬´–ö–ª—é—á ‚Äî –≤ –ø–µ—Ä–≤—ã—Ö –±—É–∫–≤–∞—Ö –Ω–∞–π–¥–µ–Ω–Ω–æ–≥–æ¬ª.
        </p>

        <div id="r1-list-block">
          <p><b>–ù–∞–π–¥–∏—Ç–µ –∏ —Å–æ–±–µ—Ä–∏—Ç–µ –ø–µ—Ä–µ–¥ —Å–æ–±–æ–π —ç—Ç–∏ 5 –ø—Ä–µ–¥–º–µ—Ç–æ–≤ (–≤ –ª—é–±–æ–º –ø–æ—Ä—è–¥–∫–µ):</b></p>
          <ul id="r1-list"></ul>
          <button id="r1-got" class="btn btn--start">–ü—Ä–µ–¥–º–µ—Ç—ã —Å–æ–±—Ä–∞–Ω—ã</button>
        </div>

        <div id="r1-pass-block" class="hidden">
          <p><b>–°–ª–æ–∂–∏—Ç–µ –ø–µ—Ä–≤—ã–µ –±—É–∫–≤—ã –ø—Ä–µ–¥–º–µ—Ç–æ–≤, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –ø–∞—Ä–æ–ª—å –∫ —Å–ª–µ–¥—É—é—â–µ–π –∫–æ–º–Ω–∞—Ç–µ.</b></p>
          <input id="r1-input" class="input" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å" />
          <div class="row" style="margin-top:10px">
            <button id="r1-check" class="btn btn--start">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
          </div>
          <div id="r1-msg" class="hint"></div>
        </div>

        <div class="hint">–ö–æ–º–Ω–∞—Ç–∞ 1 –∏–∑ 4</div>
      </div>
    </section>

    <!-- –ö–æ–º–Ω–∞—Ç–∞ 2 -->
    <section id="room2" class="card hidden">
      <div class="card-header"><img src="alchemy.png" alt="–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è –∞–ª—Ö–∏–º–∏–∫–∞" /></div>
      <div class="card-body">
        <h2>–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è –∞–ª—Ö–∏–º–∏–∫–∞ ‚Äî ¬´–¢—ë–ø–ª–æ–µ –∑–µ–ª—å–µ¬ª</h2>
        <p>–°–∏—è—é—Ç –∫–æ–ª–±—ã, –ø–∞—Ö–Ω–µ—Ç –ø–æ—Ä–æ—à–∫–∞–º–∏ –∏ —Ç—Ä–∞–≤–∞–º–∏. –ù–∞ —Å—Ç–µ–Ω–µ –ø—Ä–æ—Å—Ç—É–ø–∞—é—Ç —Å—Ç—Ä–æ–∫–∏ —Ä–µ—Ü–µ–ø—Ç–∞ ‚Äî –¥–æ–º –∂–¥—ë—Ç —Å–æ–≤–º–µ—Å—Ç–Ω–æ–≥–æ –ø—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è.</p>
        <p><b>–ü—Ä–∏–≥–æ—Ç–æ–≤—å—Ç–µ –∑–µ–ª—å–µ ¬´–û—Å–µ–Ω–Ω–µ–µ —Ç–µ–ø–ª–æ¬ª:</b></p>
        <ul>
          <li>–ö—Ä—É–∂–∫–∞ –≥–æ—Ä—è—á–µ–≥–æ —á–∞—è.</li>
          <li>–î–æ–±–∞–≤—å—Ç–µ –≥–æ—Ä—Å—Ç—å —è–≥–æ–¥ <i>–∏–ª–∏</i> –ª–æ–∂–∫—É –≤–∞—Ä–µ–Ω—å—è.</li>
          <li>–†–∞–∑–º–µ—à–∞–π—Ç–µ —á–∞–π–Ω—É—é –ª–æ–∂–∫—É –º—ë–¥–∞.</li>
          <li>–©–µ–ø–æ—Ç–∫–∞ –∫–æ—Ä–∏—Ü—ã <i>–∏–ª–∏</i> –∏–º–±–∏—Ä—è.</li>
          <li>–ü–æ –∂–µ–ª–∞–Ω–∏—é ‚Äî –Ω–µ–º–Ω–æ–≥–æ –º–æ–ª–æ–∫–∞.</li>
        </ul>
        <p>–°–¥–µ–ª–∞–π—Ç–µ –Ω–∞–ø–∏—Ç–æ–∫ –≤–º–µ—Å—Ç–µ. –ö–æ–≥–¥–∞ –≤–µ–¥—É—â–∞—è –ø–æ–ø—Ä–æ–±—É–µ—Ç ‚Äî –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ.</p>

        <div class="row" style="margin-top:10px">
          <button id="r2-confirm" class="btn btn--start">–í–µ–¥—É—â–∞—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç</button>
        </div>
        <div id="r2-msg" class="hint"></div>

        <div class="hint">–ö–æ–º–Ω–∞—Ç–∞ 2 –∏–∑ 4</div>
      </div>
    </section>

    <!-- –ö–æ–º–Ω–∞—Ç–∞ 3 -->
    <section id="room3" class="card hidden">
      <div class="card-header"><img src="mirrors.png" alt="–ó–∞–ª –∑–µ—Ä–∫–∞–ª" /></div>
      <div class="card-body">
        <h2>–ó–∞–ª –∑–µ—Ä–∫–∞–ª</h2>
        <p>–û—Ç—Ä–∞–∂–µ–Ω–∏—è –º–Ω–æ–∂–∞—Ç—Å—è, –∫–æ–º–Ω–∞—Ç–∞ —à–µ–ø—á–µ—Ç: ¬´–ü–æ–≤—Ç–æ—Ä—è–π –∏ –¥–æ–±–∞–≤–ª—è–π¬ª.</p>
        <p><b>–ó–∞–¥–∞–Ω–∏–µ:</b> –ø–µ—Ä–≤—ã–π –∏–≥—Ä–æ–∫ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ—Ä–æ—Ç–∫–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ. –°–ª–µ–¥—É—é—â–∏–π –∏–≥—Ä–æ–∫ –∫–æ–º–∞–Ω–¥—ã –ø–æ–≤—Ç–æ—Ä—è–µ—Ç –¥–≤–∏–∂–µ–Ω–∏–µ –ø–µ—Ä–≤–æ–≥–æ –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç —Å–≤–æ—ë. –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ, –ø–æ–∫–∞ –≤—Å–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏ –∫–æ–º–∞–Ω–¥—ã –Ω–µ –ø–æ–∫–∞–∂—É—Ç —Å–≤–æ–π –∂–µ—Å—Ç. –ß—Ç–æ–±—ã –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥ –∏–∑ –∫–æ–º–Ω–∞—Ç—ã ‚Äî –ø–æ–∫–∞–∂–∏—Ç–µ –≤–µ–¥—É—â–µ–π –≤—Å—é —Ü–µ–ø–æ—á–∫—É –¥–≤–∏–∂–µ–Ω–∏–π <b>—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ</b>, –≤—Å–µ –≤–º–µ—Å—Ç–µ.</p>

        <div class="row" style="margin-top:10px">
          <button id="r3-confirm" class="btn btn--start">–í–µ–¥—É—â–∞—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç</button>
        </div>
        <div id="r3-msg" class="hint"></div>

        <div class="hint">–ö–æ–º–Ω–∞—Ç–∞ 3 –∏–∑ 4</div>
      </div>
    </section>

    <!-- –ö–æ–º–Ω–∞—Ç–∞ 4 -->
    <section id="room4" class="card hidden">
      <div class="card-header"><img src="door.png" alt="–§–∏–Ω–∞–ª—å–Ω–∞—è –¥–≤–µ—Ä—å" /></div>
      <div class="card-body">
        <h2>–ü–æ—Å–ª–µ–¥–Ω—è—è –¥–≤–µ—Ä—å</h2>
        <p>–ó–∞–º–∫–∏ –Ω–µ –ø–æ–¥–¥–∞—é—Ç—Å—è —Å–∏–ª–µ. –ù–æ –∫–∞–∂–¥—ã–π –ª—é–±–∏—Ç —Ç–æ—á–Ω—ã–π –æ—Ç–≤–µ—Ç. –†–∞–∑–≥–∞–¥–∞–π—Ç–µ –≤—Å–µ –∑–∞–≥–∞–¥–∫–∏, —á—Ç–æ–±—ã –¥–≤–µ—Ä—å —â—ë–ª–∫–Ω—É–ª–∞.</p>

        <div class="riddle">
          <p>1) –ë–µ–∑ –æ–∫–æ–Ω, –±–µ–∑ –¥–≤–µ—Ä–µ–π ‚Äî –ø–æ–ª–Ω–∞ –≥–æ—Ä–Ω–∏—Ü–∞ –ª—é–¥–µ–π.</p>
          <input class="input" data-answer="–æ–≥—É—Ä–µ—Ü" placeholder="–û—Ç–≤–µ—Ç (–æ–¥–Ω–æ —Å–ª–æ–≤–æ)" />
        </div>
        <div class="riddle">
          <p>2) –î–≤–∞ –∫–æ–Ω—Ü–∞, –¥–≤–∞ –∫–æ–ª—å—Ü–∞, –ø–æ—Å—Ä–µ–¥–∏–Ω–µ –≥–≤–æ–∑–¥–∏–∫.</p>
          <input class="input" data-answer="–Ω–æ–∂–Ω–∏—Ü—ã" placeholder="–û—Ç–≤–µ—Ç (–≤–æ –º–Ω. —á–∏—Å–ª–µ)" />
        </div>
        <div class="riddle">
          <p>3) –í–∏—Å–∏—Ç –≥—Ä—É—à–∞ ‚Äî –Ω–µ–ª—å–∑—è —Å–∫—É—à–∞—Ç—å.</p>
          <input class="input" data-variants="–ª–∞–º–ø–∞,–ª–∞–º–ø–æ—á–∫–∞" placeholder="–û—Ç–≤–µ—Ç" />
        </div>
        <div class="riddle">
          <p>4) –ù–µ –ª–∞–µ—Ç, –Ω–µ –∫—É—Å–∞–µ—Ç, –≤ –¥–æ–º –Ω–µ –ø—É—Å–∫–∞–µ—Ç.</p>
          <input class="input" data-answer="–∑–∞–º–æ–∫" placeholder="–û—Ç–≤–µ—Ç" />
        </div>
        <div class="riddle">
          <p>5) –ó–∏–º–æ–π –∏ –ª–µ—Ç–æ–º –æ–¥–Ω–∏–º —Ü–≤–µ—Ç–æ–º.</p>
          <input class="input" data-variants="—ë–ª–∫–∞,–µ–ª–∫–∞" placeholder="–û—Ç–≤–µ—Ç" />
        </div>

        <div class="row" style="margin-top:10px">
          <button id="r4-check" class="btn btn--start">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–≤–µ—Ç—ã</button>
        </div>
        <div id="r4-msg" class="hint"></div>

        <div class="hint">–ö–æ–º–Ω–∞—Ç–∞ 4 –∏–∑ 4</div>
      </div>
    </section>

    <!-- –§–∏–Ω–∞–ª -->
    <section id="final" class="card hidden">
      <div class="card-header"><img src="door.png" alt="–û—Ç–∫—Ä—ã—Ç–∞—è –¥–≤–µ—Ä—å" /></div>
      <div class="card-body center">
        <h2>–î–≤–µ—Ä—å —Ä–∞—Å–ø–∞—Ö–Ω—É–ª–∞—Å—å!</h2>
        <p>–î–æ–º –ø—Ä–∏–Ω—è–ª –≤–∞—à—É —Å–º–µ–ª–æ—Å—Ç—å –∏ —Å–º–µ–∫–∞–ª–∫—É. –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞, –∫–æ–º–∞–Ω–¥–∞!</p>
        <p id="finalTeam" class="hint"></p>
        <a class="btn btn-link btn--start" href="/halloweennight/">–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–µ–Ω—é</a>
      </div>
    </section>

    <div class="footer">¬© Halloween Night</div>
  </div>

  <script>
    // ===== utils =====
    const $ = s => document.querySelector(s);
    const $all = s => Array.from(document.querySelectorAll(s));

    function setTeamPill(team){
      const pill = $('#teamPill');
      if(!team){ pill.classList.add('hidden'); pill.textContent=''; return; }
      pill.classList.remove('hidden');
      if(team==='ghost'){ pill.textContent='üëª –ü–†–ò–ó–†–ê–ö–ò'; pill.classList.add('team-ghost'); pill.classList.remove('team-hunter'); }
      else { pill.textContent='üéØ –û–•–û–¢–ù–ò–ö–ò'; pill.classList.add('team-hunter'); pill.classList.remove('team-ghost'); }
    }

    function save(key,val){ localStorage.setItem(key, JSON.stringify(val)); }
    function load(key,def=null){ try{ const v=localStorage.getItem(key); return v?JSON.parse(v):def; }catch(_){return def} }

    // ===== team bootstrap =====
    const team = load('hn_team', null);
    setTeamPill(team);

    // –ï—Å–ª–∏ –∫–æ–º–∞–Ω–¥—ã –Ω–µ—Ç ‚Äî –¥–∞—Ç—å –≤—ã–±—Ä–∞—Ç—å –ø—Ä—è–º–æ –≤ host (–∫—Ä–∞—Ç–∫–æ)
    if(!team){
      $('#teamChoice').classList.remove('hidden');
      $all('[data-choose]').forEach(b=>{
        b.addEventListener('click', ()=>{
          const t = b.dataset.choose; save('hn_team', t); setTeamPill(t);
          $('#teamChoice').classList.add('hidden');
        });
      });
    }

    // ===== Room 1 shuffle + password flow =====
    const items = ['–ò–≥—Ä—É—à–∫–∞','–ù–æ—Å–æ–∫','–ê–ª—å–±–æ–º','–ì–∞–ª—Å—Ç—É–∫','–ö—Ä—É–∂–∫–∞'];
    function shuffle(a){ for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]];} return a; }

    function buildR1(){
      const ul = $('#r1-list');
      ul.innerHTML='';
      shuffle([...items]).forEach(x=>{
        const li=document.createElement('li'); li.textContent=x; ul.appendChild(li);
      });
    }

    function showSection(id){
      ['intro','room1','room2','room3','room4','final'].forEach(i=>$('#'+i).classList.add('hidden'));
      $('#'+id).classList.remove('hidden');
    }

    function startGame(){
      const progress = load('hn_progress', 0);
      if(progress===0){ showSection('room1'); }
      else if(progress===1){ showSection('room2'); }
      else if(progress===2){ showSection('room3'); }
      else if(progress===3){ showSection('room4'); }
      else { showSection('final'); }
    }

    $('#startBtn').addEventListener('click', ()=>{
      showSection('intro'); // –ø–æ–∫–∞–∑–∞—Ç—å –≤—Å—Ç—É–ø–ª–µ–Ω–∏–µ –Ω–∞ –º–≥–Ω–æ–≤–µ–Ω–∏–µ –∏ —Å—Ä–∞–∑—É –∫ –∫–æ–º–Ω–∞—Ç–µ 1
      setTimeout(()=>{ buildR1(); showSection('room1'); }, 150);
    });

    // –°–±—Ä–æ—Å ‚Äî —á–∏—Å—Ç–∏–º –≤—Å–µ hn_ –∫–ª—é—á–∏
    function hardReset(){
      const del=[];
      for(let i=0;i<localStorage.length;i++){
        const k=localStorage.key(i);
        if(k && k.startsWith('hn_')) del.push(k);
      }
      del.forEach(k=>localStorage.removeItem(k));
      location.reload();
    }
    $('#resetBtn').addEventListener('click', hardReset);

    // Room1 interactions
    buildR1();
    $('#r1-got').addEventListener('click', ()=>{
      $('#r1-list-block').classList.add('hidden');
      $('#r1-pass-block').classList.remove('hidden');
      $('#r1-input').focus();
    });

    $('#r1-check').addEventListener('click', ()=>{
      const v = ($('#r1-input').value||'').trim().toUpperCase().replaceAll('–Å','–ï');
      if(v==='–ö–ù–ò–ì–ê'){
        $('#r1-msg').textContent='–í–µ—Ä–Ω–æ! –î–∞–ª—å—à–µ!';
        $('#room1').classList.add('success');
        save('hn_progress',1);
        setTimeout(()=>{ showSection('room2'); },600);
      }else{
        $('#r1-msg').textContent='–ù–µ —Ç–æ —Å–ª–æ–≤–æ. –ü–æ–¥—Å–∫–∞–∑–∫–∞ –±—ã–ª–∞ –≤ –ø–µ—Ä–≤—ã—Ö –±—É–∫–≤–∞—Ö –ø—Ä–µ–¥–º–µ—Ç–æ–≤.';
        $('#room1').classList.add('fail'); setTimeout(()=>$('#room1').classList.remove('fail'),700);
      }
    });

    // Long-press helper (2s)
    function longPress(btn, onSuccess){
      let t=null, down=false;
      const start=()=>{ if(down) return; down=true; t=setTimeout(()=>{ onSuccess(); down=false; },2000); };
      const end=()=>{ if(t){ clearTimeout(t); t=null; } down=false; };
      btn.addEventListener('pointerdown', start);
      btn.addEventListener('pointerup', end);
      btn.addEventListener('pointerleave', end);
      btn.addEventListener('touchstart', start, {passive:true});
      btn.addEventListener('touchend', end);
    }

    longPress($('#r2-confirm'), ()=>{
      $('#r2-msg').textContent='–ó–µ–ª—å–µ –ø—Ä–∏–Ω—è—Ç–æ. –ü—É—Ç—å –æ—Ç–∫—Ä—ã—Ç.';
      $('#room2').classList.add('success');
      save('hn_progress',2);
      setTimeout(()=>{ showSection('room3'); },600);
    });

    longPress($('#r3-confirm'), ()=>{
      $('#r3-msg').textContent='–û—Ç—Ä–∞–∂–µ–Ω–∏—è —Å–æ–≥–ª–∞—Å–Ω—ã. –ü—Ä–æ—Ö–æ–¥ –Ω–∞–π–¥–µ–Ω.';
      $('#room3').classList.add('success');
      save('hn_progress',3);
      setTimeout(()=>{ showSection('room4'); },600);
    });

    // Room4 check riddles
    $('#r4-check').addEventListener('click', ()=>{
      let ok=true;
      $all('#room4 .riddle .input').forEach(inp=>{
        const val=(inp.value||'').trim().toLowerCase();
        let good=false;
        if(inp.dataset.answer){
          good = val === inp.dataset.answer;
        }else if(inp.dataset.variants){
          const vars = inp.dataset.variants.split(',').map(s=>s.trim().toLowerCase());
          good = vars.includes(val);
        }
        if(!good){ ok=false; inp.classList.add('fail'); setTimeout(()=>inp.classList.remove('fail'),800); }
        else { inp.classList.add('success'); setTimeout(()=>inp.classList.remove('success'),800); }
      });
      if(ok){
        save('hn_progress',4);
        const t = load('hn_team', null);
        if(t){ $('#finalTeam').textContent = '–ö–æ–º–∞–Ω–¥–∞: ' + (t==='ghost'?'–ü–†–ò–ó–†–ê–ö–ò':'–û–•–û–¢–ù–ò–ö–ò'); }
        showSection('final');
      }else{
        $('#r4-msg').textContent='–ï—Å—Ç—å –æ—à–∏–±–∫–∏. –û–±—Å—É–¥–∏—Ç–µ –≤–º–µ—Å—Ç–µ –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.';
      }
    });

    // –í–æ–∑–≤—Ä–∞—Ç –ø–æ —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω–æ–º—É –ø—Ä–æ–≥—Ä–µ—Å—Å—É, –µ—Å–ª–∏ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏–ª–∏
    (function restore(){
      const p = load('hn_progress', 0);
      if(p===0){ showSection('intro'); }
      else if(p===1){ buildR1(); showSection('room2'); }
      else if(p===2){ showSection('room3'); }
      else if(p===3){ showSection('room4'); }
      else if(p>=4){
        const t = load('hn_team', null);
        if(t){ $('#finalTeam').textContent = '–ö–æ–º–∞–Ω–¥–∞: ' + (t==='ghost'?'–ü–†–ò–ó–†–ê–ö–ò':'–û–•–û–¢–ù–ò–ö–ò'); }
        showSection('final');
      }
    })();
  </script>
</body>
</html>
