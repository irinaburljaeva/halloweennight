<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>–¢–∞–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –¥–æ–º ‚Äî –ö–æ–º–∞–Ω–¥–Ω—ã–π –∫–≤–µ—Å—Ç</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;800&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#0f1115; --card:#1a1f27; --muted:#9aa4b2; --ink:#e8edf4; --accent:#ffb703;
      --bad:#ff5c7a; --good:#32d74b;
    }
    *{box-sizing:border-box}
    html,body{margin:0;background:var(--bg);color:var(--ink);font-family:Montserrat,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif}
    .wrap{max-width:960px;margin:0 auto;padding:16px 14px 80px}
    header{display:flex;align-items:center;justify-content:space-between;gap:10px;margin-bottom:14px}
    .title{font-weight:800;font-size:22px;line-height:1.2}
    .team-pill{padding:8px 14px;border-radius:999px;background:#251d27;border:1px solid #3a2b3e;font-weight:800}
    .team-ghost{box-shadow:0 0 0 2px #5a3d7a inset}
    .team-hunter{box-shadow:0 0 0 2px #2f6a9a inset}
    .btn{appearance:none;border:none;padding:10px 16px;border-radius:12px;font-weight:700;cursor:pointer}
    .btn--start{background:var(--accent);color:#1a1200}
    .btn--reset{background:#2a2f38;color:var(--ink)}
    .lang{background:#1e242d;border:1px solid #2b323c;padding:8px 14px;border-radius:8px;color:var(--ink);cursor:pointer;font-size:14px}
    .card{background:var(--card);border:1px solid #242a34;border-radius:18px;margin:14px 0;overflow:hidden}
    .card-header img{width:100%;height:220px;object-fit:cover;background:#0b0d11}
    .card-body{padding:18px}
    h2{margin:0 0 14px 0;font-size:26px}
    p{margin:0 0 12px 0}
    ul{margin:12px 0 16px 22px}
    .hint{color:var(--muted);font-size:14px;margin-top:8px}
    .hidden{display:none!important}
    .success{border:1px solid rgba(50,215,75,.35);box-shadow:0 0 0 2px rgba(50,215,75,.12) inset}
    .fail{border:1px solid rgba(255,92,122,.3);box-shadow:0 0 0 2px rgba(255,92,122,.1) inset}
    .input{width:100%;padding:12px 14px;border-radius:12px;border:1px solid #303845;background:#12161c;color:var(--ink);font-size:16px}
    .row{display:flex;gap:12px;flex-wrap:wrap}
    .center{text-align:center}
    a.btn-link{display:inline-block;text-decoration:none}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="title" data-text="title">–¢–∞–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –¥–æ–º ‚Äî –ö–æ–º–∞–Ω–¥–Ω—ã–π –∫–≤–µ—Å—Ç</div>
      <div style="display:flex;align-items:center;gap:8px">
        <div id="teamPill" class="team-pill hidden"></div>
        <select id="langSelect" class="lang">
          <option value="ru">üá∑üá∫ –†—É—Å</option>
          <option value="es">üá™üá∏ Esp</option>
        </select>
        <button id="startBtn" class="btn btn--start" data-text="start">–°—Ç–∞—Ä—Ç</button>
        <button id="resetBtn" class="btn btn--reset" data-text="reset">–°–±—Ä–æ—Å</button>
      </div>
    </header>

    <!-- –í—Å—Ç—É–ø–ª–µ–Ω–∏–µ -->
    <section id="intro" class="card">
      <div class="card-header"><img src="intro.png" alt="" /></div>
      <div class="card-body">
        <h2 data-text="introTitle">–î–æ–º –Ω–∞ —Ö–æ–ª–º–µ</h2>
        <p data-text="introText">
          –≠—Ç–æ—Ç –¥–æ–º —Å—Ç–æ–∏—Ç –Ω–∞ —Ö–æ–ª–º–µ —É–∂–µ —Å–æ—Ç–Ω–∏ –ª–µ—Ç. –ù–∏–∫—Ç–æ –Ω–µ –ø–æ–º–Ω–∏—Ç, –∫—Ç–æ –µ–≥–æ –ø–æ—Å—Ç—Ä–æ–∏–ª.
          –ù–æ –∫–∞–∂–¥—ã–π –•—ç–ª–ª–æ—É–∏–Ω –µ–≥–æ –æ–∫–Ω–∞ –≤—Å–ø—ã—Ö–∏–≤–∞—é—Ç –æ–≥–Ω—ë–º, –∞ –¥–≤–µ—Ä–∏ –æ—Ç–∫—Ä—ã–≤–∞—é—Ç—Å—è ‚Äî —Ç–æ–ª—å–∫–æ —Ç–µ–º,
          –∫—Ç–æ –æ—Å–º–µ–ª–∏—Ç—Å—è –≤–æ–π—Ç–∏. –î–æ–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç –≤–∞—Å –Ω–∞ –∫–æ–º–∞–Ω–¥—ã –∏ –≤–ø—É—Å—Ç–∏—Ç –≤ –∫–æ–º–Ω–∞—Ç—ã‚Ä¶
          –°—É–º–µ–µ—Ç–µ –ª–∏ –≤—ã –æ—Ç–∫—Ä—ã—Ç—å –ü–æ—Å–ª–µ–¥–Ω—é—é –î–≤–µ—Ä—å?
        </p>
      </div>
    </section>

    <!-- –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ -->
    <section id="room1" class="card hidden">
      <div class="card-header"><img src="library.png" alt="" /></div>
      <div class="card-body">
        <h2 data-text="r1Title">–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞</h2>
        <p data-text="r1Text">
          –ü–æ–ª–∫–∏ –¥–æ –ø–æ—Ç–æ–ª–∫–∞, –∫–∞—Ä—Ç–æ—á–Ω—ã–π –∫–∞—Ç–∞–ª–æ–≥ –∏ —Å–∫—Ä–∏–ø –ø–µ—Ä—å–µ–≤–æ–π —Ä—É—á–∫–∏. –ù–∞ —Å—Ç–æ–ª–µ –∑–∞–ø–∏—Å–∫–∞:
          ¬´–ö–ª—é—á ‚Äî –≤ –ø–µ—Ä–≤—ã—Ö –±—É–∫–≤–∞—Ö –Ω–∞–π–¥–µ–Ω–Ω–æ–≥–æ¬ª.
        </p>
        <div id="r1-list-block">
          <p data-text="r1Find">–ù–∞–π–¥–∏—Ç–µ –∏ —Å–æ–±–µ—Ä–∏—Ç–µ –ø–µ—Ä–µ–¥ —Å–æ–±–æ–π —ç—Ç–∏ 5 –ø—Ä–µ–¥–º–µ—Ç–æ–≤ (–≤ –ª—é–±–æ–º –ø–æ—Ä—è–¥–∫–µ):</p>
          <ul id="r1-list"></ul>
          <button id="r1-got" class="btn btn--start" data-text="collected">–ü—Ä–µ–¥–º–µ—Ç—ã —Å–æ–±—Ä–∞–Ω—ã</button>
        </div>
        <div id="r1-pass-block" class="hidden">
          <p data-text="r1Hint">–°–ª–æ–∂–∏—Ç–µ –ø–µ—Ä–≤—ã–µ –±—É–∫–≤—ã –ø—Ä–µ–¥–º–µ—Ç–æ–≤, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –ø–∞—Ä–æ–ª—å –∫ —Å–ª–µ–¥—É—é—â–µ–π –∫–æ–º–Ω–∞—Ç–µ.</p>
          <input id="r1-input" class="input" placeholder="–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å" />
          <button id="r1-check" class="btn btn--start" data-text="check">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å</button>
          <div id="r1-msg" class="hint"></div>
        </div>
      </div>
    </section>

    <!-- –ê–ª—Ö–∏–º–∏–∫ -->
    <section id="room2" class="card hidden">
      <div class="card-header"><img src="alchemy.png" alt="" /></div>
      <div class="card-body">
        <h2 data-text="r2Title">–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è –∞–ª—Ö–∏–º–∏–∫–∞</h2>
        <p data-text="r2Text">–°–∏—è—é—Ç –∫–æ–ª–±—ã, –ø–∞—Ö–Ω–µ—Ç –ø–æ—Ä–æ—à–∫–∞–º–∏ –∏ —Ç—Ä–∞–≤–∞–º–∏. –ù–∞ —Å—Ç–µ–Ω–µ –ø—Ä–æ—Å—Ç—É–ø–∞—é—Ç —Å—Ç—Ä–æ–∫–∏ —Ä–µ—Ü–µ–ø—Ç–∞ ‚Äî –¥–æ–º –∂–¥—ë—Ç —Å–æ–≤–º–µ—Å—Ç–Ω–æ–≥–æ –ø—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è.</p>
        <ul>
          <li data-text="r2i1">–ö—Ä—É–∂–∫–∞ –≥–æ—Ä—è—á–µ–≥–æ —á–∞—è.</li>
          <li data-text="r2i2">–î–æ–±–∞–≤—å—Ç–µ –≥–æ—Ä—Å—Ç—å —è–≥–æ–¥ –∏–ª–∏ –ª–æ–∂–∫—É –≤–∞—Ä–µ–Ω—å—è.</li>
          <li data-text="r2i3">–†–∞–∑–º–µ—à–∞–π—Ç–µ —á–∞–π–Ω—É—é –ª–æ–∂–∫—É –º—ë–¥–∞.</li>
          <li data-text="r2i4">–©–µ–ø–æ—Ç–∫–∞ –∫–æ—Ä–∏—Ü—ã –∏–ª–∏ –∏–º–±–∏—Ä—è.</li>
          <li data-text="r2i5">–ü–æ –∂–µ–ª–∞–Ω–∏—é ‚Äî –Ω–µ–º–Ω–æ–≥–æ –º–æ–ª–æ–∫–∞.</li>
        </ul>
        <button id="r2-confirm" class="btn btn--start" data-text="leaderConfirms">–í–µ–¥—É—â–∞—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç</button>
        <div id="r2-msg" class="hint"></div>
      </div>
    </section>

    <!-- –ó–∞–ª –∑–µ—Ä–∫–∞–ª -->
    <section id="room3" class="card hidden">
      <div class="card-header"><img src="mirrors.png" alt="" /></div>
      <div class="card-body">
        <h2 data-text="r3Title">–ó–∞–ª –∑–µ—Ä–∫–∞–ª</h2>
        <p data-text="r3Text">
          –û—Ç—Ä–∞–∂–µ–Ω–∏—è –º–Ω–æ–∂–∞—Ç—Å—è, –∫–æ–º–Ω–∞—Ç–∞ —à–µ–ø—á–µ—Ç: ¬´–ü–æ–≤—Ç–æ—Ä—è–π –∏ –¥–æ–±–∞–≤–ª—è–π¬ª.<br>
          –ü–µ—Ä–≤—ã–π –∏–≥—Ä–æ–∫ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ—Ä–æ—Ç–∫–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ. –°–ª–µ–¥—É—é—â–∏–π –∏–≥—Ä–æ–∫ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç –µ–≥–æ –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç —Å–≤–æ—ë.
          –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ, –ø–æ–∫–∞ –≤—Å–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏ –∫–æ–º–∞–Ω–¥—ã –Ω–µ –ø–æ–∫–∞–∂—É—Ç —Å–≤–æ–π –∂–µ—Å—Ç.  
          –ß—Ç–æ–±—ã –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥, –ø–æ–∫–∞–∂–∏—Ç–µ –≤–µ–¥—É—â–µ–π –≤—Å—é —Ü–µ–ø–æ—á–∫—É –¥–≤–∏–∂–µ–Ω–∏–π —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ.
        </p>
        <button id="r3-confirm" class="btn btn--start" data-text="leaderConfirms">–í–µ–¥—É—â–∞—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç</button>
        <div id="r3-msg" class="hint"></div>
      </div>
    </section>

    <!-- –§–∏–Ω–∞–ª—å–Ω–∞—è –¥–≤–µ—Ä—å -->
    <section id="room4" class="card hidden">
      <div class="card-header"><img src="door.png" alt="" /></div>
      <div class="card-body">
        <h2 data-text="r4Title">–ü–æ—Å–ª–µ–¥–Ω—è—è –¥–≤–µ—Ä—å</h2>
        <p data-text="r4Text">
          –í–µ—Ç–µ—Ä —Å—Ç–∏—Ö–∞–µ—Ç. –ü–µ—Ä–µ–¥ –≤–∞–º–∏ –≤—ã—Å–æ–∫–∞—è –¥–≤–µ—Ä—å, —É–∫—Ä–∞—à–µ–Ω–Ω–∞—è –¥—Ä–µ–≤–Ω–∏–º–∏ —Å–∏–º–≤–æ–ª–∞–º–∏.
          –ù–∞ –∫–∞–∂–¥–æ–º –∏–∑ –ø—è—Ç–∏ –∑–∞–º–∫–æ–≤ ‚Äî —Å–≤–æ—è –∑–∞–≥–∞–¥–∫–∞. –†–∞–∑–≥–∞–¥–∞–π—Ç–µ –≤—Å–µ, —á—Ç–æ–±—ã –¥–æ–º –æ—Ç–ø—É—Å—Ç–∏–ª –≤–∞—Å –Ω–∞ —Å–≤–æ–±–æ–¥—É.
        </p>

        <div class="riddle"><p data-text="q1">1) –û–Ω–æ –∏–¥—ë—Ç –≤–ø–µ—Ä—ë–¥, –Ω–æ –Ω–µ –¥–µ–ª–∞–µ—Ç –Ω–∏ —à–∞–≥–∞.</p><input class="input" data-answers="–≤—Ä–µ–º—è|tiempo"></div>
        <div class="riddle"><p data-text="q2">2) –ë–µ–∑ —è–∑—ã–∫–∞, –∞ –≥–æ–≤–æ—Ä–∏—Ç, –±–µ–∑ –∫—Ä—ã–ª—å–µ–≤, –∞ –ª–µ—Ç–∞–µ—Ç.</p><input class="input" data-answers="—ç—Ö–æ|eco"></div>
        <div class="riddle"><p data-text="q3">3) –°–∏–¥–∏—Ç –¥–µ–¥, –≤–æ —Å—Ç–æ —à—É–± –æ–¥–µ—Ç. –ö—Ç–æ –µ–≥–æ —Ä–∞–∑–¥–µ–≤–∞–µ—Ç ‚Äî —Ç–æ—Ç —Å–ª—ë–∑—ã –ø—Ä–æ–ª–∏–≤–∞–µ—Ç.</p><input class="input" data-answers="–ª—É–∫|cebolla"></div>
        <div class="riddle"><p data-text="q4">4) –ß—Ç–æ –º–æ–∂–Ω–æ —É–≤–∏–¥–µ—Ç—å —Å –∑–∞–∫—Ä—ã—Ç—ã–º–∏ –≥–ª–∞–∑–∞–º–∏?</p><input class="input" data-answers="—Å–æ–Ω|sue√±o|sueno"></div>
        <div class="riddle"><p data-text="q5">5) –ë–µ–∑ —Ä—É–∫, –±–µ–∑ –Ω–æ–≥, –∞ –≤–æ—Ä–æ—Ç–∞ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç.</p><input class="input" data-answers="–≤–µ—Ç–µ—Ä|viento"></div>

        <button id="r4-check" class="btn btn--start" data-text="check">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–≤–µ—Ç—ã</button>
        <div id="r4-msg" class="hint"></div>
      </div>
    </section>

    <!-- –§–∏–Ω–∞–ª -->
    <section id="final" class="card hidden">
      <div class="card-header"><img src="door.png" alt="" /></div>
      <div class="card-body center">
        <h2 data-text="finalTitle">–î–≤–µ—Ä—å —Ä–∞—Å–ø–∞—Ö–Ω—É–ª–∞—Å—å!</h2>
        <p data-text="finalText">–î–æ–º –ø—Ä–∏–Ω—è–ª –≤–∞—à—É —Å–º–µ–ª–æ—Å—Ç—å –∏ —Å–º–µ–∫–∞–ª–∫—É. –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞, –∫–æ–º–∞–Ω–¥–∞!</p>
        <p id="finalTeam" class="hint"></p>
        <a href="/halloweennight/" class="btn btn-link btn--start" data-text="back">–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–µ–Ω—é</a>
      </div>
    </section>
  </div>

  <script>
    // ===== helpers =====
    const $=s=>document.querySelector(s);
    const $$=s=>Array.from(document.querySelectorAll(s));
    const save=(k,v)=>localStorage.setItem(k,JSON.stringify(v));
    const load=(k,d=null)=>{try{const v=localStorage.getItem(k);return v?JSON.parse(v):d}catch{return d}};

    // ===== i18n =====
    const LKEY='hn_lang';
    function getLang(){
      const q = new URLSearchParams(location.search).get('lang');
      if(q){ localStorage.setItem(LKEY,q); return q; }
      return localStorage.getItem(LKEY) || 'ru';
    }
    let LANG = getLang();
    const i18n = {
      ru:{
        title:'–¢–∞–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –¥–æ–º ‚Äî –ö–æ–º–∞–Ω–¥–Ω—ã–π –∫–≤–µ—Å—Ç',
        start:'–°—Ç–∞—Ä—Ç', reset:'–°–±—Ä–æ—Å',
        introTitle:'–î–æ–º –Ω–∞ —Ö–æ–ª–º–µ',
        introText:'–≠—Ç–æ—Ç –¥–æ–º —Å—Ç–æ–∏—Ç –Ω–∞ —Ö–æ–ª–º–µ —É–∂–µ —Å–æ—Ç–Ω–∏ –ª–µ—Ç. –ù–∏–∫—Ç–æ –Ω–µ –ø–æ–º–Ω–∏—Ç, –∫—Ç–æ –µ–≥–æ –ø–æ—Å—Ç—Ä–æ–∏–ª. –ù–æ –∫–∞–∂–¥—ã–π –•—ç–ª–ª–æ—É–∏–Ω –µ–≥–æ –æ–∫–Ω–∞ –≤—Å–ø—ã—Ö–∏–≤–∞—é—Ç –æ–≥–Ω—ë–º, –∞ –¥–≤–µ—Ä–∏ –æ—Ç–∫—Ä—ã–≤–∞—é—Ç—Å—è ‚Äî —Ç–æ–ª—å–∫–æ —Ç–µ–º, –∫—Ç–æ –æ—Å–º–µ–ª–∏—Ç—Å—è –≤–æ–π—Ç–∏. –î–æ–º —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–∏—Ç –≤–∞—Å –Ω–∞ –∫–æ–º–∞–Ω–¥—ã –∏ –≤–ø—É—Å—Ç–∏—Ç –≤ –∫–æ–º–Ω–∞—Ç—ã‚Ä¶ –°—É–º–µ–µ—Ç–µ –ª–∏ –≤—ã –æ—Ç–∫—Ä—ã—Ç—å –ü–æ—Å–ª–µ–¥–Ω—é—é –î–≤–µ—Ä—å?',
        r1Title:'–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞',
        r1Text:'–ü–æ–ª–∫–∏ –¥–æ –ø–æ—Ç–æ–ª–∫–∞, –∫–∞—Ä—Ç–æ—á–Ω—ã–π –∫–∞—Ç–∞–ª–æ–≥ –∏ —Å–∫—Ä–∏–ø –ø–µ—Ä—å–µ–≤–æ–π —Ä—É—á–∫–∏. –ù–∞ —Å—Ç–æ–ª–µ –∑–∞–ø–∏—Å–∫–∞: ¬´–ö–ª—é—á ‚Äî –≤ –ø–µ—Ä–≤—ã—Ö –±—É–∫–≤–∞—Ö –Ω–∞–π–¥–µ–Ω–Ω–æ–≥–æ¬ª.',
        r1Find:'–ù–∞–π–¥–∏—Ç–µ –∏ —Å–æ–±–µ—Ä–∏—Ç–µ –ø–µ—Ä–µ–¥ —Å–æ–±–æ–π —ç—Ç–∏ 5 –ø—Ä–µ–¥–º–µ—Ç–æ–≤ (–≤ –ª—é–±–æ–º –ø–æ—Ä—è–¥–∫–µ):',
        collected:'–ü—Ä–µ–¥–º–µ—Ç—ã —Å–æ–±—Ä–∞–Ω—ã', r1Hint:'–°–ª–æ–∂–∏—Ç–µ –ø–µ—Ä–≤—ã–µ –±—É–∫–≤—ã –ø—Ä–µ–¥–º–µ—Ç–æ–≤, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –ø–∞—Ä–æ–ª—å –∫ —Å–ª–µ–¥—É—é—â–µ–π –∫–æ–º–Ω–∞—Ç–µ.',
        check:'–ü—Ä–æ–≤–µ—Ä–∏—Ç—å',
        r2Title:'–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è –∞–ª—Ö–∏–º–∏–∫–∞',
        r2Text:'–°–∏—è—é—Ç –∫–æ–ª–±—ã, –ø–∞—Ö–Ω–µ—Ç –ø–æ—Ä–æ—à–∫–∞–º–∏ –∏ —Ç—Ä–∞–≤–∞–º–∏. –ù–∞ —Å—Ç–µ–Ω–µ –ø—Ä–æ—Å—Ç—É–ø–∞—é—Ç —Å—Ç—Ä–æ–∫–∏ —Ä–µ—Ü–µ–ø—Ç–∞ ‚Äî –¥–æ–º –∂–¥—ë—Ç —Å–æ–≤–º–µ—Å—Ç–Ω–æ–≥–æ –ø—Ä–∏–≥–æ—Ç–æ–≤–ª–µ–Ω–∏—è.',
        r2i1:'–ö—Ä—É–∂–∫–∞ –≥–æ—Ä—è—á–µ–≥–æ —á–∞—è.', r2i2:'–î–æ–±–∞–≤—å—Ç–µ –≥–æ—Ä—Å—Ç—å —è–≥–æ–¥ –∏–ª–∏ –ª–æ–∂–∫—É –≤–∞—Ä–µ–Ω—å—è.', r2i3:'–†–∞–∑–º–µ—à–∞–π—Ç–µ —á–∞–π–Ω—É—é –ª–æ–∂–∫—É –º—ë–¥–∞.',
        r2i4:'–©–µ–ø–æ—Ç–∫–∞ –∫–æ—Ä–∏—Ü—ã –∏–ª–∏ –∏–º–±–∏—Ä—è.', r2i5:'–ü–æ –∂–µ–ª–∞–Ω–∏—é ‚Äî –Ω–µ–º–Ω–æ–≥–æ –º–æ–ª–æ–∫–∞.',
        leaderConfirms:'–í–µ–¥—É—â–∞—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç',
        r3Title:'–ó–∞–ª –∑–µ—Ä–∫–∞–ª',
        r3Text:'–û—Ç—Ä–∞–∂–µ–Ω–∏—è –º–Ω–æ–∂–∞—Ç—Å—è, –∫–æ–º–Ω–∞—Ç–∞ —à–µ–ø—á–µ—Ç: ¬´–ü–æ–≤—Ç–æ—Ä—è–π –∏ –¥–æ–±–∞–≤–ª—è–π¬ª. –ü–µ—Ä–≤—ã–π –∏–≥—Ä–æ–∫ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–æ—Ä–æ—Ç–∫–æ–µ –¥–≤–∏–∂–µ–Ω–∏–µ. –°–ª–µ–¥—É—é—â–∏–π –∏–≥—Ä–æ–∫ –ø–æ–≤—Ç–æ—Ä—è–µ—Ç –µ–≥–æ –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç —Å–≤–æ—ë. –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ, –ø–æ–∫–∞ –≤—Å–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏ –∫–æ–º–∞–Ω–¥—ã –Ω–µ –ø–æ–∫–∞–∂—É—Ç —Å–≤–æ–π –∂–µ—Å—Ç. –ß—Ç–æ–±—ã –Ω–∞–π—Ç–∏ –≤—ã—Ö–æ–¥, –ø–æ–∫–∞–∂–∏—Ç–µ –≤–µ–¥—É—â–µ–π –≤—Å—é —Ü–µ–ø–æ—á–∫—É –¥–≤–∏–∂–µ–Ω–∏–π —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ.',
        r4Title:'–ü–æ—Å–ª–µ–¥–Ω—è—è –¥–≤–µ—Ä—å',
        r4Text:'–í–µ—Ç–µ—Ä —Å—Ç–∏—Ö–∞–µ—Ç. –ü–µ—Ä–µ–¥ –≤–∞–º–∏ –≤—ã—Å–æ–∫–∞—è –¥–≤–µ—Ä—å, —É–∫—Ä–∞—à–µ–Ω–Ω–∞—è –¥—Ä–µ–≤–Ω–∏–º–∏ —Å–∏–º–≤–æ–ª–∞–º–∏. –ù–∞ –∫–∞–∂–¥–æ–º –∏–∑ –ø—è—Ç–∏ –∑–∞–º–∫–æ–≤ ‚Äî —Å–≤–æ—è –∑–∞–≥–∞–¥–∫–∞. –†–∞–∑–≥–∞–¥–∞–π—Ç–µ –≤—Å–µ, —á—Ç–æ–±—ã –¥–æ–º –æ—Ç–ø—É—Å—Ç–∏–ª –≤–∞—Å –Ω–∞ —Å–≤–æ–±–æ–¥—É.',
        q1:'1) –û–Ω–æ –∏–¥—ë—Ç –≤–ø–µ—Ä—ë–¥, –Ω–æ –Ω–µ –¥–µ–ª–∞–µ—Ç –Ω–∏ —à–∞–≥–∞.',
        q2:'2) –ë–µ–∑ —è–∑—ã–∫–∞, –∞ –≥–æ–≤–æ—Ä–∏—Ç, –±–µ–∑ –∫—Ä—ã–ª—å–µ–≤, –∞ –ª–µ—Ç–∞–µ—Ç.',
        q3:'3) –°–∏–¥–∏—Ç –¥–µ–¥, –≤–æ —Å—Ç–æ —à—É–± –æ–¥–µ—Ç. –ö—Ç–æ –µ–≥–æ —Ä–∞–∑–¥–µ–≤–∞–µ—Ç ‚Äî —Ç–æ—Ç —Å–ª—ë–∑—ã –ø—Ä–æ–ª–∏–≤–∞–µ—Ç.',
        q4:'4) –ß—Ç–æ –º–æ–∂–Ω–æ —É–≤–∏–¥–µ—Ç—å —Å –∑–∞–∫—Ä—ã—Ç—ã–º–∏ –≥–ª–∞–∑–∞–º–∏?',
        q5:'5) –ë–µ–∑ —Ä—É–∫, –±–µ–∑ –Ω–æ–≥, –∞ –≤–æ—Ä–æ—Ç–∞ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç.',
        finalTitle:'–î–≤–µ—Ä—å —Ä–∞—Å–ø–∞—Ö–Ω—É–ª–∞—Å—å!',
        finalText:'–î–æ–º –ø—Ä–∏–Ω—è–ª –≤–∞—à—É —Å–º–µ–ª–æ—Å—Ç—å –∏ —Å–º–µ–∫–∞–ª–∫—É. –û—Ç–ª–∏—á–Ω–∞—è —Ä–∞–±–æ—Ç–∞, –∫–æ–º–∞–Ω–¥–∞!',
        back:'–í–µ—Ä–Ω—É—Ç—å—Å—è –≤ –º–µ–Ω—é'
      },
      es:{
        title:'La Casa Misteriosa ‚Äî Misi√≥n en equipos',
        start:'Comenzar', reset:'Reiniciar',
        introTitle:'La casa en la colina',
        introText:'Esta casa lleva siglos en la colina. Nadie recuerda qui√©n la construy√≥. Cada Halloween, sus ventanas arden y las puertas se abren para quienes se atreven a entrar. La casa os dividir√° en equipos y os dejar√° pasar a sus salas‚Ä¶ ¬øPodr√©is abrir la √öltima Puerta?',
        r1Title:'Biblioteca',
        r1Text:'Estanter√≠as hasta el techo y el crujido de una pluma. En la mesa: ¬´La clave est√° en las primeras letras de lo encontrado¬ª.',
        r1Find:'Encontrad y poned delante estos 5 objetos (en cualquier orden):',
        collected:'Objetos reunidos', r1Hint:'Tomad las primeras letras de los objetos para obtener la contrase√±a de la siguiente sala.',
        check:'Verificar',
        r2Title:'Laboratorio del alquimista',
        r2Text:'Brillan los frascos; huele a polvos y hierbas. En la pared aparece una receta: la casa quiere que la prepar√©is juntos.',
        r2i1:'Una taza de t√© caliente.', r2i2:'A√±adid un pu√±ado de bayas o una cucharada de mermelada.',
        r2i3:'Disolved una cucharadita de miel.', r2i4:'Una pizca de canela o jengibre.', r2i5:'Opcional: un poco de leche.',
        leaderConfirms:'Confirma la anfitriona',
        r3Title:'Sala de los Espejos',
        r3Text:'Los reflejos se multiplican: ¬´Repite y a√±ade¬ª. El primero muestra un movimiento corto; el siguiente lo repite y a√±ade el suyo. Seguid hasta que todos participen. Para salir, mostrad a la anfitriona toda la secuencia sincronizada.',
        r4Title:'Puerta final',
        r4Text:'El viento se calma. Una puerta alta con s√≠mbolos antiguos. Cada una de sus cinco cerraduras tiene un acertijo. Abridlas todas para salir.',
        q1:'1) Avanza hacia adelante pero no da ning√∫n paso.',
        q2:'2) Sin lengua habla, sin alas vuela.',
        q3:'3) Sentado est√°, con cien abrigos; quien lo desnuda derrama l√°grimas.',
        q4:'4) ¬øQu√© puedes ver con los ojos cerrados?',
        q5:'5) Sin manos ni pies, abre las puertas.',
        finalTitle:'¬°La puerta se abri√≥!',
        finalText:'La casa acept√≥ vuestro valor e ingenio. ¬°Gran trabajo, equipo!',
        back:'Volver al men√∫'
      }
    };

    const applyI18n=()=>{
      $('#langSelect').value = LANG;
      $$('[data-text]').forEach(el=>{
        const key=el.getAttribute('data-text');
        if(i18n[LANG] && i18n[LANG][key]) el.textContent = i18n[LANG][key];
      });
      // placeholders
      const r1input = $('#r1-input'); if(r1input){ r1input.placeholder = LANG==='es'?'Introduce la contrase√±a':'–í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–æ–ª—å'; }
      // –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞: —Å–ø–∏—Å–æ–∫ –ø—Ä–µ–¥–º–µ—Ç–æ–≤ (RU —Å ES –≤ —Å–∫–æ–±–∫–∞—Ö)
      const items = [
        '–ò–≥—Ä—É—à–∫–∞ (juguete)',
        '–ù–æ—Å–æ–∫ (calcet√≠n)',
        '–ê–ª—å–±–æ–º (√°lbum)',
        '–ì–∞–ª—Å—Ç—É–∫ (corbata)',
        '–ö—Ä—É–∂–∫–∞ (taza)'
      ];
      const ul = $('#r1-list');
      if(ul && ul.children.length===0){
        // –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞—Ö–æ–¥–µ –Ω–∞–ø–æ–ª–Ω–∏–º; –ø—Ä–∏ –ø–æ—Å–ª–µ–¥—É—é—â–∏—Ö ‚Äî –Ω–∞–ø–æ–ª–Ω—è–µ—Ç buildR1()
        items.forEach(x=>{ const li=document.createElement('li'); li.textContent=x; ul.appendChild(li); });
      }
    };

    // ===== –∫–æ–º–∞–Ω–¥–∞ (–ø–ª–∞—à–∫–∞) =====
    const team = load('hn_team',null);
    const teamPill = $('#teamPill');
    if(team){
      teamPill.classList.remove('hidden');
      teamPill.textContent = team==='ghost' ? 'üëª –ü–†–ò–ó–†–ê–ö–ò' : 'üéØ –û–•–û–¢–ù–ò–ö–ò';
      teamPill.classList.add(team==='ghost'?'team-ghost':'team-hunter');
    }

    // ===== –±–∏–±–ª–∏–æ—Ç–µ–∫–∞: –ø–µ—Ä–µ–º–µ—à–∏–≤–∞–Ω–∏–µ –∏ –ª–æ–≥–∏–∫–∞ =====
    function shuffle(a){ for(let i=a.length-1;i>0;i--){const j=Math.floor(Math.random()*(i+1));[a[i],a[j]]=[a[j],a[i]];} return a; }
    function buildR1(){
      const src = [
        '–ò–≥—Ä—É—à–∫–∞ (juguete)',
        '–ù–æ—Å–æ–∫ (calcet√≠n)',
        '–ê–ª—å–±–æ–º (√°lbum)',
        '–ì–∞–ª—Å—Ç—É–∫ (corbata)',
        '–ö—Ä—É–∂–∫–∞ (taza)'
      ];
      const ul=$('#r1-list'); ul.innerHTML='';
      shuffle(src).forEach(x=>{ const li=document.createElement('li'); li.textContent=x; ul.appendChild(li); });
    }

    function showSection(id){
      ['intro','room1','room2','room3','room4','final'].forEach(s=>$('#'+s).classList.add('hidden'));
      $('#'+id).classList.remove('hidden');
      window.scrollTo({top:0,behavior:'smooth'});
    }

    // ===== —Å—Ç–∞—Ä—Ç/—Å–±—Ä–æ—Å =====
    $('#startBtn').addEventListener('click',()=>{
      $('#startBtn').classList.add('hidden');
      buildR1();
      showSection('room1');
    });

    $('#resetBtn').addEventListener('click',()=>{
      const del=[];
      for(let i=0;i<localStorage.length;i++){
        const k=localStorage.key(i);
        if(k && k.startsWith('hn_')) del.push(k);
      }
      del.forEach(k=>localStorage.removeItem(k));
      location.reload();
    });

    // –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞: —Å–∫—Ä—ã—Ç—å —Å–ø–∏—Å–æ–∫ -> –≤–≤–æ–¥ –ø–∞—Ä–æ–ª—è
    $('#r1-got').addEventListener('click',()=>{
      $('#r1-list-block').classList.add('hidden');
      $('#r1-pass-block').classList.remove('hidden');
      $('#r1-input').focus();
    });

    const norm = s => (s||'').toLowerCase().replace('—ë','–µ').trim();
    $('#r1-check').addEventListener('click',()=>{
      const v = norm($('#r1-input').value);
      const ok = (v==='–∫–Ω–∏–≥–∞' || v==='libro');
      const msg=$('#r1-msg');
      if(ok){
        msg.textContent = LANG==='es' ? '¬°Correcto! Pasad a la siguiente sala.' : '–í–µ—Ä–Ω–æ! –î–∞–ª—å—à–µ!';
        $('#room1').classList.add('success'); save('hn_progress',1);
        setTimeout(()=>showSection('room2'),600);
      }else{
        msg.textContent = LANG==='es' ? 'No. Pista: primeras letras de los objetos.' : '–ù–µ —Ç–æ —Å–ª–æ–≤–æ. –ü–æ–¥—Å–∫–∞–∑–∫–∞ –±—ã–ª–∞ –≤ –ø–µ—Ä–≤—ã—Ö –±—É–∫–≤–∞—Ö –ø—Ä–µ–¥–º–µ—Ç–æ–≤.';
        $('#room1').classList.add('fail'); setTimeout(()=>$('#room1').classList.remove('fail'),700);
      }
    });

    // ===== –¥–æ–ª–≥–∏–π —Ç–∞–ø –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è (2 —Å–µ–∫), –±–µ–∑ –ø–æ–¥—Å–∫–∞–∑–æ–∫ –≤ —Ç–µ–∫—Å—Ç–µ =====
    function longPress(el, cb){
      let t; let down=false;
      const start=()=>{ if(down) return; down=true; t=setTimeout(()=>{ cb(); down=false; },2000); };
      const end=()=>{ if(t){clearTimeout(t); t=null;} down=false; };
      el.addEventListener('pointerdown', start);
      el.addEventListener('pointerup', end);
      el.addEventListener('pointerleave', end);
      el.addEventListener('touchstart', start, {passive:true});
      el.addEventListener('touchend', end);
      el.addEventListener('touchcancel', end);
    }
    longPress($('#r2-confirm'),()=>{ $('#r2-msg').textContent= LANG==='es' ? 'El elixir est√° aprobado.' : '–ó–µ–ª—å–µ –ø—Ä–∏–Ω—è—Ç–æ.'; $('#room2').classList.add('success'); save('hn_progress',2); setTimeout(()=>showSection('room3'),600); });
    longPress($('#r3-confirm'),()=>{ $('#r3-msg').textContent= LANG==='es' ? 'Los espejos aceptan la secuencia.' : '–û—Ç—Ä–∞–∂–µ–Ω–∏—è —Å–æ–≥–ª–∞—Å–Ω—ã.'; $('#room3').classList.add('success'); save('hn_progress',3); setTimeout(()=>showSection('room4'),600); });

    // ===== —Ñ–∏–Ω–∞–ª—å–Ω–∞—è –¥–≤–µ—Ä—å: –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ RU/ES =====
    $('#r4-check').addEventListener('click',()=>{
      let ok=true;
      $$('#room4 input').forEach(inp=>{
        const v = norm(inp.value);
        const list = (inp.dataset.answers||'').split('|').map(s=>norm(s));
        const good = list.includes(v);
        if(!good){ ok=false; inp.classList.add('fail'); setTimeout(()=>inp.classList.remove('fail'),800); }
        else { inp.classList.add('success'); setTimeout(()=>inp.classList.remove('success'),800); }
      });
      if(ok){
        save('hn_progress',4);
        const t = load('hn_team',null);
        if(t){
          $('#finalTeam').textContent = (LANG==='es'?'Equipo: ':'–ö–æ–º–∞–Ω–¥–∞: ') + (t==='ghost' ? (LANG==='es'?'FANTASMAS':'–ü–†–ò–ó–†–ê–ö–ò') : (LANG==='es'?'CAZADORES':'–û–•–û–¢–ù–ò–ö–ò'));
        } else {
          $('#finalTeam').textContent = '';
        }
        showSection('final');
      }else{
        $('#r4-msg').textContent = LANG==='es' ? 'Hay errores. Pensad juntos e intentad de nuevo.' : '–ï—Å—Ç—å –æ—à–∏–±–∫–∏. –û–±—Å—É–¥–∏—Ç–µ –≤–º–µ—Å—Ç–µ –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â—ë —Ä–∞–∑.';
      }
    });

    // ===== –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ =====
    (function restore(){
      // —è–∑—ã–∫
      $('#langSelect').value = LANG;
      applyI18n();

      const p = load('hn_progress',0);
      if(p>0){ $('#startBtn').classList.add('hidden'); }
      if(p===0){ showSection('intro'); }
      else if(p===1){ buildR1(); showSection('room2'); }
      else if(p===2){ showSection('room3'); }
      else if(p===3){ showSection('room4'); }
      else if(p>=4){
        const t = load('hn_team',null);
        if(t){
          $('#finalTeam').textContent = (LANG==='es'?'Equipo: ':'–ö–æ–º–∞–Ω–¥–∞: ') + (t==='ghost' ? (LANG==='es'?'FANTASMAS':'–ü–†–ò–ó–†–ê–ö–ò') : (LANG==='es'?'CAZADORES':'–û–•–û–¢–ù–ò–ö–ò'));
        }
        showSection('final');
      }
    })();

    // ===== –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —è–∑—ã–∫–∞ =====
    $('#langSelect').addEventListener('change',()=>{
      LANG = $('#langSelect').value;
      localStorage.setItem(LKEY, LANG);
      // –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∞—Ç—å —Ç–µ–∫—Å—Ç—ã
      applyI18n();
    });

    // –ø–µ—Ä–≤–∏—á–Ω–∞—è –æ—Ç—Ä–∏—Å–æ–≤–∫–∞ i18n (–Ω–∞ —Å–ª—É—á–∞–π –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–π —Å–º–µ–Ω—ã)
    applyI18n();
  </script>
</body>
</html>
